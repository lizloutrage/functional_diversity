<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Liz Loutrage">

<title>index</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="index_files/libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="index_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="index_files/libs/datatables-binding-0.30/datatables.js"></script>
<script src="index_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="index_files/libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="index_files/libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="index_files/libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="index_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="index_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#questions" id="toc-questions" class="nav-link active" data-scroll-target="#questions">Questions</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">1. Data preparation</a>
  <ul class="collapse">
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">summary</a></li>
  <li><a href="#species-traits" id="toc-species-traits" class="nav-link" data-scroll-target="#species-traits">Species * traits</a>
  <ul class="collapse">
  <li><a href="#data-imputation" id="toc-data-imputation" class="nav-link" data-scroll-target="#data-imputation">data imputation</a></li>
  <li><a href="#calctulate-functional-traits" id="toc-calctulate-functional-traits" class="nav-link" data-scroll-target="#calctulate-functional-traits">calctulate functional traits</a></li>
  </ul></li>
  <li><a href="#species-assemblages-matrix" id="toc-species-assemblages-matrix" class="nav-link" data-scroll-target="#species-assemblages-matrix">Species * assemblages matrix</a></li>
  <li><a href="#traits-types" id="toc-traits-types" class="nav-link" data-scroll-target="#traits-types">Traits types</a></li>
  </ul></li>
  <li><a href="#build-a-functional-space-using-the-mfd-package" id="toc-build-a-functional-space-using-the-mfd-package" class="nav-link" data-scroll-target="#build-a-functional-space-using-the-mfd-package">2. Build a functional space using the mFD package</a>
  <ul class="collapse">
  <li><a href="#compute-data-summaries" id="toc-compute-data-summaries" class="nav-link" data-scroll-target="#compute-data-summaries">2.1 Compute data summaries</a></li>
  <li><a href="#computing-distances-between-species-based-on-functional-traits" id="toc-computing-distances-between-species-based-on-functional-traits" class="nav-link" data-scroll-target="#computing-distances-between-species-based-on-functional-traits">2.2 Computing distances between species based on functional traits</a></li>
  <li><a href="#building-functional-spaces-and-chosing-the-best-one" id="toc-building-functional-spaces-and-chosing-the-best-one" class="nav-link" data-scroll-target="#building-functional-spaces-and-chosing-the-best-one">2.3 Building functional spaces and chosing the best one</a>
  <ul class="collapse">
  <li><a href="#computing-several-multimensional-functional-spaces-and-assessing-their-quality" id="toc-computing-several-multimensional-functional-spaces-and-assessing-their-quality" class="nav-link" data-scroll-target="#computing-several-multimensional-functional-spaces-and-assessing-their-quality">2.3.1 Computing several multimensional functional spaces and assessing their quality</a></li>
  <li><a href="#illustrating-the-quality-of-the-functional-spaces" id="toc-illustrating-the-quality-of-the-functional-spaces" class="nav-link" data-scroll-target="#illustrating-the-quality-of-the-functional-spaces">2.3.2 Illustrating the quality of the functional spaces</a></li>
  <li><a href="#testing-the-correlation-between-functional-axes-and-traits" id="toc-testing-the-correlation-between-functional-axes-and-traits" class="nav-link" data-scroll-target="#testing-the-correlation-between-functional-axes-and-traits">2.3.3 Testing the correlation between functional axes and traits</a></li>
  </ul></li>
  <li><a href="#plotting-the-selected-functional-space-and-position-of-species" id="toc-plotting-the-selected-functional-space-and-position-of-species" class="nav-link" data-scroll-target="#plotting-the-selected-functional-space-and-position-of-species">2.4 Plotting the selected functional space and position of species</a></li>
  </ul></li>
  <li><a href="#computing-and-plotting-fd-indices-using-the-mfd-package" id="toc-computing-and-plotting-fd-indices-using-the-mfd-package" class="nav-link" data-scroll-target="#computing-and-plotting-fd-indices-using-the-mfd-package">3. Computing and plotting FD indices using the mFD package</a>
  <ul class="collapse">
  <li><a href="#computing-and-plotting-alpha-fd-indices" id="toc-computing-and-plotting-alpha-fd-indices" class="nav-link" data-scroll-target="#computing-and-plotting-alpha-fd-indices">3.1 Computing and plotting alpha FD indices</a>
  <ul class="collapse">
  <li><a href="#fric-functional-richness" id="toc-fric-functional-richness" class="nav-link" data-scroll-target="#fric-functional-richness"><strong>FRic Functional Richness</strong></a></li>
  <li><a href="#fdiv-functional-divergence" id="toc-fdiv-functional-divergence" class="nav-link" data-scroll-target="#fdiv-functional-divergence"><strong>FDiv Functional Divergence</strong></a></li>
  <li><a href="#fspe-functional-specialization" id="toc-fspe-functional-specialization" class="nav-link" data-scroll-target="#fspe-functional-specialization"><strong>FSpe Functional Specialization</strong></a></li>
  <li><a href="#fdis-functional-dispersion" id="toc-fdis-functional-dispersion" class="nav-link" data-scroll-target="#fdis-functional-dispersion"><strong>FDis Functional Dispersion</strong></a></li>
  <li><a href="#fide-functional-identity" id="toc-fide-functional-identity" class="nav-link" data-scroll-target="#fide-functional-identity"><strong>FIde Functional Identity</strong></a></li>
  </ul></li>
  <li><a href="#computing-and-plotting-beta-fd-indices" id="toc-computing-and-plotting-beta-fd-indices" class="nav-link" data-scroll-target="#computing-and-plotting-beta-fd-indices">3.2.Computing and plotting beta FD indices</a></li>
  </ul></li>
  <li><a href="#functional-rarity" id="toc-functional-rarity" class="nav-link" data-scroll-target="#functional-rarity">4. Functional rarity</a>
  <ul class="collapse">
  <li><a href="#different-indices-of-functional-rarity" id="toc-different-indices-of-functional-rarity" class="nav-link" data-scroll-target="#different-indices-of-functional-rarity">4.1 Different indices of functional rarity</a></li>
  <li><a href="#computing-functional-rarity" id="toc-computing-functional-rarity" class="nav-link" data-scroll-target="#computing-functional-rarity">4.2.Computing functional rarity</a>
  <ul class="collapse">
  <li><a href="#functional-originality-at-regional-scale" id="toc-functional-originality-at-regional-scale" class="nav-link" data-scroll-target="#functional-originality-at-regional-scale">4.2.1 Functional originality at regional scale</a></li>
  <li><a href="#functional-originality-at-local-scale" id="toc-functional-originality-at-local-scale" class="nav-link" data-scroll-target="#functional-originality-at-local-scale">4.2.2 Functional originality at local scale</a></li>
  </ul></li>
  <li><a href="#plotting-functional-rarity" id="toc-plotting-functional-rarity" class="nav-link" data-scroll-target="#plotting-functional-rarity">4.3 Plotting functional rarity</a>
  <ul class="collapse">
  <li><a href="#plotting-functional-originality" id="toc-plotting-functional-originality" class="nav-link" data-scroll-target="#plotting-functional-originality">4.3.1 Plotting functional originality</a></li>
  <li><a href="#plotting-rarity" id="toc-plotting-rarity" class="nav-link" data-scroll-target="#plotting-rarity">4.3.2. Plotting rarity</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">index</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Liz Loutrage </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="questions" class="level1">
<h1>Questions</h1>
<ul>
<li><p><span style="color:#2596be;"><strong>β-functional diversity</strong></span>: calcul des indices de dissimilarité entre les assemblages (profondeurs) : profondeur = filtre environnemental ?</p>
<ul>
<li><p><em>Turnover</em>: élevé s’il n’y a pas de combinaison de traits partagés entre les assemblages</p></li>
<li><p><em>Nestedness component</em>: élevé si un assemblage abrite un petit sous-ensemble des stratégies fonctionnelles présentes dans l’autre</p></li>
</ul></li>
<li><p><span style="color:#2596be;"><strong>Functional rarity</strong></span>:</p>
<ul>
<li>Différencier échelle locale et régionale ?</li>
<li>inclure abondance/biomasse ?</li>
<li>y a t-il beaucoup d’espèces avec des combinaisons de traits uniques ?</li>
<li>y a en t-il plus en profondeur ?</li>
<li>les espèces fonctionnellement rares ont t-elles une distribution plus restreinte ?</li>
</ul></li>
</ul>
</section>
<section id="data-preparation" class="level1">
<h1>1. Data preparation</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>morphometric_data <span class="ot">&lt;-</span> utils<span class="sc">::</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"morphometrics_data.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> T, <span class="at">dec =</span> <span class="st">"."</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>morpho_data <span class="ot">&lt;-</span> morphometric_data <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(variable_abbreviation, variable_unit)) <span class="sc">%&gt;%</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">row_to_names</span>(<span class="at">row_number =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">rownames&lt;-</span><span class="st">`</span>(<span class="cn">NULL</span>)<span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># delete for now (n=1)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">!=</span> <span class="st">"Diaphus_sp"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># replace empty value by NA </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>morpho_data[morpho_data <span class="sc">==</span><span class="st">""</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Numeric variables</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>morpho_data[, <span class="dv">4</span><span class="sc">:</span><span class="dv">23</span>] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(morpho_data[, <span class="dv">4</span><span class="sc">:</span><span class="dv">23</span>], as.numeric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">summary</h3>
<ul>
<li>total measure = 359</li>
<li>total of species measured = 32</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>morpho_data_summary <span class="ot">&lt;-</span>morpho_data <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(species)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">tagList</span>(DT<span class="sc">::</span><span class="fu">datatable</span>(morpho_data_summary))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b61aa818ad60beb20269" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b61aa818ad60beb20269">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["Anoplogaster_cornuta","Arctozenus_risso","Argyropelecus_hemigymnus","Argyropelecus_olfersii","Bathylagus_euryops","Benthosema_glaciale","Bolinichthys_supralateralis","Borostomias_antarcticus","Ceratoscopelus_maderensis","Chauliodus_sloani","Cyclothone_sp","Derichthys_serpentinus","Diaphus_metoclampus","Eurypharynx_pelecanoides","Evermannella_balbo","Gonostoma_elongatum","Holtbyrnia_anomala","Holtbyrnia_macrops","Lampanyctus_ater","Lampanyctus_crocodilus","Lampanyctus_macdonaldi","Lestidiops_sphyrenoides","Lobianchia_gemellarii","Malacosteus_niger","Maulisia_argipalla","Maulisia_mauli","Maulisia_microlepis","Maurolicus_muelleri","Melanostigma_atlanticum","Melanostomias_bartonbeani","Myctophum_punctatum","Normichthys_operosus","Notoscopelus_bolini","Notoscopelus_kroyeri","Paralepis_coregonoides ","Photostylus_pycnopterus","Sagamichthys_schnakenbecki","Searsia_koefoedi","Serrivomer_beanii","Sigmops_bathyphilus","Stomias_boa","Xenodermichthys_copei"],[3,30,17,37,19,20,11,14,30,12,12,7,5,6,4,3,3,9,22,39,21,7,22,5,5,11,4,11,20,9,25,38,20,36,19,8,9,36,30,20,26,38]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>species<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="species-traits" class="level2">
<h2 class="anchored" data-anchor-id="species-traits">Species * traits</h2>
<section id="data-imputation" class="level3">
<h3 class="anchored" data-anchor-id="data-imputation">data imputation</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select numeric variables for imputation </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>morpho_num <span class="ot">&lt;-</span> morpho_data <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">23</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>imputed_data <span class="ot">&lt;-</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  mice<span class="sc">::</span><span class="fu">mice</span>(morpho_num,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">maxit =</span> <span class="dv">50</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">printFlag=</span>F)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>completed_data <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(imputed_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calctulate-functional-traits" class="level3">
<h3 class="anchored" data-anchor-id="calctulate-functional-traits">calctulate functional traits</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate functional numeric traits</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>morpho_numeric <span class="ot">&lt;-</span> completed_data <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>individual_code) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">eye_size =</span> eye_diameter <span class="sc">/</span> head_depth,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">orbital_length =</span> eye_diameter <span class="sc">/</span> standard_length,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">oral_gap_surface =</span> mouth_width <span class="sc">*</span> mouth_depth <span class="sc">/</span> body_width <span class="sc">*</span> body_depth,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">oral_gape_shape =</span> mouth_depth <span class="sc">/</span> mouth_width,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">oral_gape_position =</span> distance_upper_jaws_bottom_head <span class="sc">/</span> head_depth,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_jaw_length =</span> lower_jaw_length <span class="sc">/</span> standard_length,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">head_length =</span> head_length <span class="sc">/</span> standard_length,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">body_depth =</span> body_depth <span class="sc">/</span> standard_length,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">pectoral_fin_position =</span> distance_pectoral_bottom_body <span class="sc">/</span> body_depth_pectoral_insertion,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">pectoral_fin_insertion =</span> prepectoral_length <span class="sc">/</span> standard_length,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">transversal_shape =</span> body_depth <span class="sc">/</span> body_width,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">dorsal_fin_insertion =</span> predorsal_length <span class="sc">/</span> standard_length,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">eye_position =</span> eye_height <span class="sc">/</span> head_depth,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">operculum_volume =</span> operculum_depth <span class="sc">/</span> operculum_width</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    species,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    eye_size,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    orbital_length,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    oral_gap_surface,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    oral_gape_shape,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    oral_gape_position,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    lower_jaw_length,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    operculum_width,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    head_length,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    body_depth,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    pectoral_fin_position,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    pectoral_fin_insertion,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    transversal_shape,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    caudal_peduncle_min_depth,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    dorsal_fin_insertion,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    eye_position,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    operculum_volume</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(species)</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="co"># categorial traits for species without NA</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>cat_morpho <span class="ot">&lt;-</span> morpho_data <span class="sc">%&gt;%</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    species,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    photophores_ventral_position ,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    gland_head,</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    chin_barbel,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    front_barbel,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    small_teeth,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    large_teeth,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    fang_teeth,</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    retractile_teeth,</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    internal_teeth,</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    gill_raker_types,</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    oral_gape_axis</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(species)</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a><span class="co"># combined the two data frames</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>fish_traits <span class="ot">&lt;-</span> morpho_numeric <span class="sc">%&gt;%</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(cat_morpho, <span class="at">by =</span> <span class="st">"species"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"species"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assign trait type </span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># as.factor for qualitative traits</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># as.ordered for odered variables</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"gill_raker_types"</span>, <span class="st">"oral_gape_axis"</span>), as.ordered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Display the table ----</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">tagList</span>(DT<span class="sc">::</span><span class="fu">datatable</span>(fish_traits))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2864be0c0094fbcea6b8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2864be0c0094fbcea6b8">{"x":{"filter":"none","vertical":false,"data":[["Anoplogaster_cornuta","Arctozenus_risso","Argyropelecus_hemigymnus","Argyropelecus_olfersii","Bathylagus_euryops","Benthosema_glaciale","Bolinichthys_supralateralis","Borostomias_antarcticus","Ceratoscopelus_maderensis","Chauliodus_sloani","Cyclothone_sp","Derichthys_serpentinus","Diaphus_metoclampus","Evermannella_balbo","Gonostoma_elongatum","Holtbyrnia_anomala","Holtbyrnia_macrops","Lampanyctus_ater","Lampanyctus_crocodilus","Lampanyctus_macdonaldi","Lestidiops_sphyrenoides","Lobianchia_gemellarii","Malacosteus_niger","Maulisia_argipalla","Maulisia_mauli","Maulisia_microlepis","Maurolicus_muelleri","Melanostigma_atlanticum","Melanostomias_bartonbeani","Myctophum_punctatum","Normichthys_operosus","Notoscopelus_bolini","Notoscopelus_kroyeri","Paralepis_coregonoides ","Photostylus_pycnopterus","Sagamichthys_schnakenbecki","Searsia_koefoedi","Serrivomer_beanii","Sigmops_bathyphilus","Stomias_boa","Xenodermichthys_copei"],[0.1870635427569378,0.5846309826745519,0.2528378924337218,0.4592456778322155,0.8073379156515913,0.553876225297698,0.6943542959568116,0.3918502902611463,0.6283997564870827,0.3236216278441371,0.2896732995527421,0.7087200272405964,0.3965409748630725,0.4619095739058715,0.2627730950311468,0.7001620679316158,0.5861245029650884,0.5876906171451259,0.5870177305121238,0.4635401519874494,0.6379293967644859,0.4655204987772433,0.5686707446196964,0.5560047681071145,0.5436602586272192,0.4040027222573614,0.5366700102175092,0.5653194882201393,0.3404604909527202,0.5253244611262143,0.5446404207622028,0.58721677071155,0.5113840280260891,0.6557709453691855,0.3160340663331095,0.6531117613886723,0.5879149224883636,0.5765207995552576,0.3439623137409401,0.7090121921743234,0.4296875],[0.06513101563336203,0.04373517018184282,0.1103521526110715,0.1502130097325588,0.09938039796259482,0.09708002840620254,0.1002020784107539,0.0454502028499367,0.08169052017109087,0.03195944404217845,0.01820101324427989,0.01870641840179216,0.08617787828321036,0.06111392066224541,0.02365859567134613,0.107319044568802,0.09736638359612411,0.04953860514578357,0.07212330160492497,0.05324648475404745,0.03316666671153076,0.06137020103787766,0.0589832944995062,0.08848446584142593,0.0843550572708857,0.05808421042835739,0.0978961923388425,0.04280718124696028,0.02667037338846572,0.102088606810114,0.09612954738570681,0.06117253100231441,0.0829147173874412,0.05113309818745389,0.03048020374468671,0.08748603143506498,0.07579150239724425,0.005392035446476243,0.03401701434877021,0.03544892518496002,0.03],[5842.317456564917,2111.722684686202,529.649932788448,1577.147761649424,215.6744532820656,288.0952119082589,857.141772877457,2308.803855788343,1150.885005261976,1427.556961259949,472.0229634409745,102.2063575036608,509.9151356625916,746.3340129817943,6250.383835528853,1069.928509005572,870.8481183231795,1516.361659863597,1697.767213931643,2223.938773657847,178.4598940858916,1226.901459954854,4216.396258458542,3465.852896151474,2055.911596674011,1384.771960858673,186.8514118522354,78.39976364627458,2537.245636289088,1190.246320535136,1490.110812657505,486.4451319733718,1884.787897717559,208.4731695208822,80.09634693327251,848.5770168784057,1121.886976386014,13856.24507766957,4544.83974684605,660.3541125369107,3128.224808219178],[0.6488731902095241,1.338469099476293,1.419691902006563,1.03165709575236,1.208429987743106,1.157723276407389,1.145308631944953,0.9549389452177165,1.143504719001661,2.198671222745045,2.196516066163295,1.689339435970036,0.944195077723388,1.283292920158411,0.6068674018540213,1.078672179961666,1.246595443731965,1.144873224338048,1.21245598924451,1.162473804130551,2.422986953900589,1.100038150697565,0.8484726822993502,1.230101510957001,1.163701414828532,1.248535562855231,1.285170782096033,1.345688706965169,1.398821013856888,1.230126420256282,1.168410973543925,1.278747111079255,1.23328408850495,1.257275949159544,1.080061200669548,1.215185926388624,1.051275601333645,1.390674506837714,1.023028473395861,2.073736388290534,1.209851822186624],[0.3951426840833095,0.5936920275250842,0.5404276289037069,0.6267609459347112,0.3502518371432042,0.3324025605583356,0.3380289556040331,0.4826993703447641,0.499666832134522,0.7068627312794583,0.7937932689673789,0.492756633741221,0.3551554524927789,0.5829657156202231,0.4721898773185077,0.4712003973315194,0.3956514300993943,0.5670948561072423,0.5763546408927493,0.5744746730161431,0.5520998821851169,0.5212153959103951,0.3530711561087431,0.4631356481458706,0.3738738564459647,0.2036324254692755,0.5855853143839959,0.4857260963559027,0.6176663797525285,0.4937836384577197,0.5383848074193586,0.4896021576606608,0.6766829935960927,0.4245107644843942,0.5624538104272562,0.361697362365493,0.6725516967007241,1.301709739258645,0.6490690083932986,0.4893190215677281,0.4674479166666667],[0.2861375317012913,0.1419299685239746,0.2514373364077059,0.2936861124939084,0.07663827540787548,0.1884618356794901,0.19638076001865,0.198414842989372,0.1723957271341177,0.1144114643871464,0.2040581908463124,0.04491240788019163,0.191587307998245,0.1634947940484265,0.1777783246347302,0.2092942077891755,0.2069838979262741,0.1973450981018806,0.2160878749273041,0.2048825282290511,0.1027761390567869,0.2223712374577787,0.2544654948963843,0.2078438651875588,0.2120154019923103,0.1744403226406842,0.166670163223075,0.03814429068386168,0.1234687560304594,0.1709386276379063,0.2124814802283585,0.2008815666871479,0.1944790792579468,0.1330213734139315,0.08475918421735412,0.1571232489521016,0.1796959703213518,0.1051773540657428,0.2267422887328622,0.08012031757545401,0.1059090909090909],[20.92,9.996666666666666,5.214117647058823,15.0927027027027,8.536315789473685,4.7555,12.47272727272727,15.79642857142857,10.359,10.1375,7.638333333333334,2.771428571428571,6.976,9.282500000000001,27.92,9.563333333333333,9.283333333333333,18.38136363636364,16.44564102564103,25.00333333333333,4.607142857142858,15.45818181818182,22.672,15.524,15.73,21.49,3.591818181818182,4.033,18.11777777777778,11.6064,12.00684210526316,9.629,11.93888888888889,4.898421052631579,6.5525,11.76,10.92333333333333,11.41733333333333,18.1015,9.640000000000001,14],[0.3471179569492232,0.2009929585768647,0.3034423890185704,0.4430016839620673,0.2252652480176319,0.2577329098405489,0.2949444282485461,0.2219516612342632,0.2810060482912339,0.1353122370036637,0.2203047019193976,0.09229259278317947,0.2626215465872482,0.2169720130174164,0.208131053502031,0.3736914296278676,0.3084118074275706,0.2268293066821225,0.2952402466992932,0.2544000525765622,0.179483203158696,0.2690716828129346,0.2291135730880142,0.3581617707887102,0.3386367195769682,0.2602094930995654,0.2861583530888247,0.1289222320266107,0.1414616221329245,0.3106499916582697,0.3367281575818815,0.2484099358389354,0.2934608456754343,0.2491930232735534,0.1610794295053864,0.3035521067765809,0.2693301083783761,0.09565857463839177,0.2463809400095261,0.1408472718663085,0.1672727272727273],[0.496765317595603,0.1206694146969274,0.5465676366743593,0.4638582588424479,0.1803023935359234,0.227186906305348,0.23575289155312,0.1471579276088384,0.2129271582075423,0.1139788839951372,0.1385564389886054,0.06475552609724118,0.2794661893586785,0.1854842390181648,0.1439966534398835,0.1995718556257012,0.1884279714218087,0.1634270563148341,0.2262550151064295,0.1791292477891186,0.07016698379208147,0.2389029851391781,0.1846729123532705,0.2190923414047283,0.2006259493110997,0.2145214178694734,0.2284769602774343,0.08730489814688717,0.1281404978381019,0.2657415518634131,0.2667515421825118,0.1977431521215698,0.2287584626732439,0.09127720302297426,0.148949033138653,0.1648207240422557,0.2089522151774925,0.05817864030760073,0.1460846094753337,0.08296986687063404,0.1513636363636363],[0.327552178795381,0.3886495663795672,0.2307451284370966,0.2772889216093987,0.1987584730572414,0.4427266302964014,0.4605590043104663,0.1754328409583324,0.2744389419969662,0.289631998528789,0.1992742880547905,0.6600484532653362,0.2327118342280331,0.215888746321026,0.2073022595505449,0.2511962839831692,0.2467697101111054,0.2892874845482781,0.320647684200895,0.1887452339268505,0.3583607039010895,0.2710821884027898,0.2070338218789051,0.1986434877697646,0.1907795219830297,0.1746990027397655,0.2251067492779084,0.3125584835447972,0.2233648323381441,0.2811404615012355,0.2636255375035926,0.2851868407331372,0.3015650260524716,0.2229812001799436,0.4749769701497314,0.2183612406444402,0.2594134992787389,0.5005157102849597,0.1973392223033529,0.1543301939549473,0.5674978503869302],[0.4003208996368177,0.236057925483874,0.2779352032788916,0.5401390627099971,0.2630250912769236,0.2999602281286219,0.3283279074114032,0.2369008386437003,0.3197499208694726,0.1525109091904405,0.2296622405613443,0.1305046806357046,0.3359303818851376,0.234931461549684,0.2185105436064756,0.3836208813775061,0.3557612665211258,0.2542559135404931,0.3578735448733034,0.3991766831105948,0.1873220233715019,0.2905759860794116,0.1740874348298388,0.3692829665519732,0.3636636301971131,0.3343165173045963,0.2720666504252247,0.1370431628331831,0.1596798610655336,0.3422495725959262,0.3771845995309003,0.2755915950773311,0.3528001856126906,0.2654937591570808,0.1830307523791412,0.365134201678179,0.3105924160886941,0.1023626617132965,0.2852113862556448,0.1296918739730582,0.1409090909090909],[0.0371234059465991,0.0322419350331208,0.2549015223177563,0.07619150444435517,0.0328441524554353,0.09109791643347125,0.01988857958867888,0.03631916674726406,0.04678411498293825,0.01525793056447875,0.07135857193615111,0.01046142821823197,0.05850109312007883,0.0330170205426,0.01553375842430409,0.06429066383512382,0.04055065658457224,0.02463758734428551,0.03192293778820045,0.01871587454424042,0.01805418174713717,0.03025781637891173,0.02411855326084547,0.07493646258320825,0.03196526524002068,0.01480309413827949,0.1787182752269798,0.04130241912511247,0.01959986641736065,0.05942358687160085,0.05969822531543297,0.02763011114739326,0.04960846559295785,0.06703510034705321,0.02971955680387246,0.04254465702825964,0.04035864302866191,0.01340758519582868,0.08468757530738309,0.02174715733754718,0.0188497679157704],[10.45666666666667,5.042333333333334,3.425882352941176,6.817837837837838,6.301578947368421,3.3485,10.79727272727273,5.527142857142857,5.363,6.194166666666667,2.8375,2.242857142857143,5.86,6.265,12.76,4.013333333333334,6.078888888888889,8.561818181818182,8.955128205128204,13.30904761904762,2.92,8.897727272727273,8.033999999999999,5.81,7.612727272727272,18.175,2.204545454545455,1.3475,4.792222222222223,5.504,5.44,6.7935,6.163888888888889,2.601052631578948,3.58375,5.828888888888889,7.266388888888889,6.264333333333333,3.299,2.037307692307692,5],[0.4441498752678317,0.4511748320752814,0.3558469543404688,0.7818238531938475,0.4724103928052195,0.4676150398984861,0.4469769590756064,0.5484990764909237,0.6234586368613509,0.2551650456937953,0.5434318108133503,0.3116459625644058,0.4068008790692222,0.4314272231538535,0.5671939001428983,0.6326973503856025,0.6361420651390463,0.4410062335674381,0.4759239546486726,0.4509057936924641,0.5980112926718268,0.4076621012576387,0.8268335886150313,0.6409601116629159,0.6344647156330613,0.6389295252984915,0.5480099853470315,0.4902538416315447,0.8479658564847968,0.7034331504327653,0.6754663550372079,0.3681530667791175,0.5244857983331518,0.6313155638870939,0.7766759118958205,0.6195601138458109,0.506573238418478,0.3299632556271487,0.5465635247269044,0.8863608137478909,0.3959090909090909],[0.7176935425650939,0.6214972793973041,0.8378677998173621,0.7271622676008382,0.6759418666886342,0.52169659214019,0.5912844468134186,0.6406218602628342,0.7013777002628838,0.7608914348764781,0.9524117126142014,0.6792564664135844,0.5025961273814956,0.8025189634953906,0.6875363082898668,0.6816922245429579,0.6757727860416617,0.6434772867086079,0.6214480626877658,0.6741368657991837,0.6136384769387926,0.6326776614466724,0.6113076825121152,0.6801791224383178,0.6352660702821236,0.7404149553188488,0.6295496228498633,0.6523412642442598,0.7023241150122855,0.6002872769321257,0.6912700288852882,0.5509132572485328,0.6778850177784417,0.6770228372535668,0.7832793790368987,0.5912461332246149,0.6977929602446417,0.8624986131376594,0.6995258484505198,0.8310676664827777,0.380859375],[1.91753487412749,1.431454025467558,2.139885271329579,1.220534807560166,1.124312726235241,1.615591789989959,1.266547465086961,0.9001426533263226,1.293273756758089,2.160667691433549,1.010216217178132,2.02597438517849,1.6964688060974,1.342729773708559,1.125109185048073,1.005414520892331,1.256182599309575,0.745538622186577,0.915004846827665,0.6972474697559381,1.513782115016354,0.9216188402082974,1.314990184872054,1.051571563080083,1.1351500186845,1.563131800106226,1.403601622773818,1.394534509216571,1.484009375370477,1.155465122079889,1.15501147000044,1.031327676466461,1.378982647187706,0.957153868401671,1.436677037589144,0.9152335515764092,1.4386979519368,3.24426452933186,0.8037016931661495,1.51291183767707,1.185714285714286],["A","A","P","P","A","P","P","P","P","P","P","P","P","A","P","A","P","P","P","P","A","P","A","P","P","A","P","A","P","P","P","P","P","A","P","P","P","A","P","P","A"],["A","A","A","A","A","A","A","A","A","P","A","A","A","A","A","A","A","A","A","A","A","A","P","A","A","A","A","A","P","A","A","A","A","A","A","A","A","A","A","P","A"],["A","A","A","A","A","A","A","P","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","P","A","A","A","A","A","A","A","A","A","A","P","A"],["A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","P","A","A","A","A","A","A","A"],["A","P","P","P","P","P","A","P","P","A","A","P","P","A","P","P","P","P","P","P","P","P","A","P","P","P","P","A","A","P","P","P","P","A","P","P","P","P","P","P","P"],["P","A","A","A","A","A","A","P","A","P","P","A","A","P","P","A","A","A","A","P","A","P","P","A","A","A","A","A","P","A","A","A","A","A","A","A","A","A","P","A","A"],["P","A","A","A","A","A","A","P","A","P","A","A","A","P","A","A","A","A","A","A","A","A","P","A","A","A","A","A","P","A","A","A","A","A","A","A","A","A","A","P","A"],["A","A","A","A","A","A","A","A","A","A","A","A","A","P","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A"],["P","P","A","A","P","P","P","P","P","A","P","A","A","A","P","A","A","P","P","P","P","P","P","P","P","P","A","A","P","P","P","P","P","P","A","A","P","P","P","P","A"],["C","B","C","C","C","C","C","C","C","A","C","A","C","A","C","C","C","C","C","C","B","C","A","C","C","C","C","B","A","C","C","C","C","A","C","C","C","A","C","A","C"],["1","3","1","1","2","3","2","2","3","1","2","3","1","1","1","3","3","2","3","2","3","2","1","2","2","2","2","3","3","3","2","3","3","3","1","2","2","3","2","2","2"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>eye_size<\/th>\n      <th>orbital_length<\/th>\n      <th>oral_gap_surface<\/th>\n      <th>oral_gape_shape<\/th>\n      <th>oral_gape_position<\/th>\n      <th>lower_jaw_length<\/th>\n      <th>operculum_width<\/th>\n      <th>head_length<\/th>\n      <th>body_depth<\/th>\n      <th>pectoral_fin_position<\/th>\n      <th>pectoral_fin_insertion<\/th>\n      <th>transversal_shape<\/th>\n      <th>caudal_peduncle_min_depth<\/th>\n      <th>dorsal_fin_insertion<\/th>\n      <th>eye_position<\/th>\n      <th>operculum_volume<\/th>\n      <th>photophores_ventral_position<\/th>\n      <th>gland_head<\/th>\n      <th>chin_barbel<\/th>\n      <th>front_barbel<\/th>\n      <th>small_teeth<\/th>\n      <th>large_teeth<\/th>\n      <th>fang_teeth<\/th>\n      <th>retractile_teeth<\/th>\n      <th>internal_teeth<\/th>\n      <th>gill_raker_types<\/th>\n      <th>oral_gape_axis<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="species-assemblages-matrix" class="level2">
<h2 class="anchored" data-anchor-id="species-assemblages-matrix">Species * assemblages matrix</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># list of species </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sp_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rownames</span>(fish_traits), <span class="st">"Nannobrachium_atrum"</span>, <span class="st">"Cyclothone"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># species biomass x depth  matrix 2002-2019 ----</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>data_biomass_2002_2019 <span class="ot">&lt;-</span> utils<span class="sc">::</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"data_biomass_2002_2019.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> T, <span class="at">dec =</span> <span class="st">"."</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"species"</span><span class="ot">=</span><span class="st">"Code_Station"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species=</span> <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>, species))<span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">%in%</span>sp_names)<span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()<span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">row_to_names</span>(<span class="at">row_number =</span> <span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.numeric)<span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"Code_Station"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="sc">!</span>Code_Station, <span class="at">names_to =</span> <span class="st">"species"</span>, <span class="at">values_to =</span> <span class="st">"Tot_V_HV"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Nom_Scientifique"</span><span class="ot">=</span><span class="st">"species"</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># species biomass x depth  matrix 2021 ----</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>data_biomass_2021 <span class="ot">&lt;-</span> utils<span class="sc">::</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"data_evhoe_catch_2021.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> T, <span class="at">dec =</span> <span class="st">"."</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Nom_Scientifique, Tot_V_HV, Code_Station)<span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()<span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Nom_Scientifique=</span> <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,Nom_Scientifique))<span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Nom_Scientifique<span class="sc">%in%</span>sp_names)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># species biomass x depth  matrix 2022 ----</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>data_biomass_2022 <span class="ot">&lt;-</span> utils<span class="sc">::</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"data_evhoe_catch_2022.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> T, <span class="at">dec =</span> <span class="st">"."</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Nom_Scientifique, Tot_V_HV, Code_Station)<span class="sc">%&gt;%</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()<span class="sc">%&gt;%</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Nom_Scientifique=</span> <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,Nom_Scientifique))<span class="sc">%&gt;%</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Nom_Scientifique<span class="sc">%in%</span>sp_names)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co"># merge all matrix ----</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co"># depth of all stations </span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>depth_station <span class="ot">&lt;-</span> utils<span class="sc">::</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"depth.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> T, <span class="at">dec =</span> <span class="st">"."</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Code_Station"</span><span class="ot">=</span><span class="st">"Station"</span>)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>depth_fish_biomass <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_biomass_2002_2019, data_biomass_2021, data_biomass_2022)<span class="sc">%&gt;%</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(depth_station)<span class="sc">%&gt;%</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Code_Station <span class="sc">!=</span> <span class="st">"H0472"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"species"</span><span class="ot">=</span><span class="st">"Nom_Scientifique"</span>)<span class="sc">%&gt;%</span>  </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add column with depth layer</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_layer =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">between</span>(depth, <span class="dv">0</span>, <span class="dv">174</span>) <span class="sc">~</span> <span class="st">"Epipelagic"</span>,</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">between</span>(depth, <span class="dv">175</span>, <span class="dv">699</span>) <span class="sc">~</span> <span class="st">"Upper mesopelagic"</span>,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">between</span>(depth, <span class="dv">700</span>, <span class="dv">999</span>) <span class="sc">~</span> <span class="st">"Lower mesopelagic"</span>,</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">between</span>(depth, <span class="dv">1000</span>, <span class="dv">2000</span>) <span class="sc">~</span> <span class="st">"Bathypelagic"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>depth)<span class="sc">%&gt;%</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, depth_layer)<span class="sc">%&gt;%</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biomass=</span><span class="fu">sum</span>(Tot_V_HV))<span class="sc">%&gt;%</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Tot_V_HV, Code_Station))<span class="sc">%&gt;%</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()<span class="sc">%&gt;%</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> species, <span class="at">values_from =</span> biomass)<span class="sc">%&gt;%</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">"depth_layer"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>))<span class="sc">%&gt;%</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>  <span class="co">#change species name</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Lampanyctus_ater"</span><span class="ot">=</span><span class="st">"Nannobrachium_atrum"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Cyclothone_sp"</span><span class="ot">=</span><span class="st">"Cyclothone"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><strong>assemblages</strong> = depth layers</li>
<li><strong>biomass data</strong> = all EVHOE data 2002-2022</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">tagList</span>(DT<span class="sc">::</span><span class="fu">datatable</span>(depth_fish_biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-140a2748bae0dce6e466" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-140a2748bae0dce6e466">{"x":{"filter":"none","vertical":false,"data":[["Upper mesopelagic","Bathypelagic","Epipelagic","Lower mesopelagic"],[0,0.1,0,0],[3.26,1.41,0.2,2.7],[0.1,0.01,0,0.01],[4.3,1.14,0.08,0.97],[0,2.71,0,0],[0.22,4.15,0.6899999999999999,0.9],[0,0.06,0,0.16],[0.02,0.57,0,0.04],[2.13,0.63,0.51,0.62],[0.04,0.97,0,0.24],[0.11,194.62,0.02,1.44],[0.03,0.05,0,0.09],[0.02,0.05,0,0.37],[0,0.14,0,0.28],[0,0.21,0,0],[0.06,0.03,0,0.03],[6.76,12.8,0.47,10.23],[0,2.23,0,0],[0.01,0.03,0.06,0.11],[0.14,0.49,0.03,0.09],[0.08,0.5,0,0],[0,0.22,0,0.13],[0.01,1.38,0,0.05],[0,0.99,0,0],[0.18,0.5,0.5600000000000001,2.4],[0.03,0.24,0.01,0.12],[0.28,0.27,0.01,0.16],[1.07,1.37,1.21,1.27],[0.07000000000000001,1.69,0.01,0.5600000000000001],[0,5.36,0,0],[4.92,3.12,0.27,2.05],[0,0.06,0,0],[0.04,0.04,0,0.14],[0.31,0.83,0.15,1.15],[0.9,5.64,0.22,1.8],[0,0.24,0,0],[14.19,3.27,0.19,8.199999999999999],[0,0.08,0.43,0.05]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Anoplogaster_cornuta<\/th>\n      <th>Arctozenus_risso<\/th>\n      <th>Argyropelecus_hemigymnus<\/th>\n      <th>Argyropelecus_olfersii<\/th>\n      <th>Bathylagus_euryops<\/th>\n      <th>Benthosema_glaciale<\/th>\n      <th>Bolinichthys_supralateralis<\/th>\n      <th>Borostomias_antarcticus<\/th>\n      <th>Ceratoscopelus_maderensis<\/th>\n      <th>Chauliodus_sloani<\/th>\n      <th>Cyclothone_sp<\/th>\n      <th>Derichthys_serpentinus<\/th>\n      <th>Evermannella_balbo<\/th>\n      <th>Gonostoma_elongatum<\/th>\n      <th>Holtbyrnia_anomala<\/th>\n      <th>Holtbyrnia_macrops<\/th>\n      <th>Lampanyctus_crocodilus<\/th>\n      <th>Lampanyctus_macdonaldi<\/th>\n      <th>Lestidiops_sphyrenoides<\/th>\n      <th>Lobianchia_gemellarii<\/th>\n      <th>Malacosteus_niger<\/th>\n      <th>Maulisia_argipalla<\/th>\n      <th>Maulisia_mauli<\/th>\n      <th>Maulisia_microlepis<\/th>\n      <th>Maurolicus_muelleri<\/th>\n      <th>Melanostigma_atlanticum<\/th>\n      <th>Melanostomias_bartonbeani<\/th>\n      <th>Myctophum_punctatum<\/th>\n      <th>Lampanyctus_ater<\/th>\n      <th>Normichthys_operosus<\/th>\n      <th>Notoscopelus_kroyeri<\/th>\n      <th>Photostylus_pycnopterus<\/th>\n      <th>Sagamichthys_schnakenbecki<\/th>\n      <th>Searsia_koefoedi<\/th>\n      <th>Serrivomer_beanii<\/th>\n      <th>Sigmops_bathyphilus<\/th>\n      <th>Xenodermichthys_copei<\/th>\n      <th>Notoscopelus_bolini<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="traits-types" class="level2">
<h2 class="anchored" data-anchor-id="traits-types">Traits types</h2>
<p>The <strong>first column</strong> contains <strong>traits name</strong>. The <strong>second column</strong> contains <strong>traits type</strong> following this code:</p>
<ul>
<li><strong>N</strong>: nominal trait (factor variable)</li>
<li><strong>O</strong>: ordinal traits (ordered variable)</li>
<li><strong>Q</strong>: quantitative traits (numeric values)</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fish_traits_cat <span class="ot">&lt;-</span> utils<span class="sc">::</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"fish_traits_cat.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> T, <span class="at">dec =</span> <span class="st">"."</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">tagList</span>(DT<span class="sc">::</span><span class="fu">datatable</span>(fish_traits_cat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5d7c9f424724fc988244" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5d7c9f424724fc988244">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27"],["eye_size","orbital_length","oral_gap_surface","oral_gape_shape","oral_gape_position","lower_jaw_length","operculum_width","head_length","body_depth","pectoral_fin_position","pectoral_fin_insertion","transversal_shape","caudal_peduncle_min_depth","dorsal_fin_insertion","eye_position","operculum_volume","photophores_ventral_position","gland_head","chin_barbel","front_barbel","small_teeth","large_teeth","fang_teeth","retractile_teeth","internal_teeth","gill_raker_types","oral_gape_axis"],["Q","Q","Q","Q","Q","Q","Q","Q","Q","Q","Q","Q","Q","Q","Q","Q","N","N","N","N","N","N","N","N","N","O","O"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait_name<\/th>\n      <th>trait_type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="build-a-functional-space-using-the-mfd-package" class="level1">
<h1>2. Build a functional space using the mFD package</h1>
<section id="compute-data-summaries" class="level2">
<h2 class="anchored" data-anchor-id="compute-data-summaries">2.1 Compute data summaries</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Summary of the assemblages * species data.frame ----</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>asb_sp_fish_summ <span class="ot">&lt;-</span> mFD<span class="sc">::</span><span class="fu">asb.sp.summary</span>(<span class="at">asb_sp_w =</span> depth_fish_biomass)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>asb_sp_fish_occ  <span class="ot">&lt;-</span> asb_sp_fish_summ<span class="sc">$</span><span class="st">"asb_sp_occ"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">tagList</span>(DT<span class="sc">::</span><span class="fu">datatable</span>(asb_sp_fish_occ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7f64fa3a64537c7624b1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7f64fa3a64537c7624b1">{"x":{"filter":"none","vertical":false,"data":[["Upper mesopelagic","Bathypelagic","Epipelagic","Lower mesopelagic"],[0,1,0,0],[1,1,1,1],[1,1,0,1],[1,1,1,1],[0,1,0,0],[1,1,1,1],[0,1,0,1],[1,1,0,1],[1,1,1,1],[1,1,0,1],[1,1,1,1],[1,1,0,1],[1,1,0,1],[0,1,0,1],[0,1,0,0],[1,1,0,1],[1,1,1,1],[0,1,0,0],[1,1,1,1],[1,1,1,1],[1,1,0,0],[0,1,0,1],[1,1,0,1],[0,1,0,0],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[0,1,0,0],[1,1,1,1],[0,1,0,0],[1,1,0,1],[1,1,1,1],[1,1,1,1],[0,1,0,0],[1,1,1,1],[0,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Anoplogaster_cornuta<\/th>\n      <th>Arctozenus_risso<\/th>\n      <th>Argyropelecus_hemigymnus<\/th>\n      <th>Argyropelecus_olfersii<\/th>\n      <th>Bathylagus_euryops<\/th>\n      <th>Benthosema_glaciale<\/th>\n      <th>Bolinichthys_supralateralis<\/th>\n      <th>Borostomias_antarcticus<\/th>\n      <th>Ceratoscopelus_maderensis<\/th>\n      <th>Chauliodus_sloani<\/th>\n      <th>Cyclothone_sp<\/th>\n      <th>Derichthys_serpentinus<\/th>\n      <th>Evermannella_balbo<\/th>\n      <th>Gonostoma_elongatum<\/th>\n      <th>Holtbyrnia_anomala<\/th>\n      <th>Holtbyrnia_macrops<\/th>\n      <th>Lampanyctus_crocodilus<\/th>\n      <th>Lampanyctus_macdonaldi<\/th>\n      <th>Lestidiops_sphyrenoides<\/th>\n      <th>Lobianchia_gemellarii<\/th>\n      <th>Malacosteus_niger<\/th>\n      <th>Maulisia_argipalla<\/th>\n      <th>Maulisia_mauli<\/th>\n      <th>Maulisia_microlepis<\/th>\n      <th>Maurolicus_muelleri<\/th>\n      <th>Melanostigma_atlanticum<\/th>\n      <th>Melanostomias_bartonbeani<\/th>\n      <th>Myctophum_punctatum<\/th>\n      <th>Lampanyctus_ater<\/th>\n      <th>Normichthys_operosus<\/th>\n      <th>Notoscopelus_kroyeri<\/th>\n      <th>Photostylus_pycnopterus<\/th>\n      <th>Sagamichthys_schnakenbecki<\/th>\n      <th>Searsia_koefoedi<\/th>\n      <th>Serrivomer_beanii<\/th>\n      <th>Sigmops_bathyphilus<\/th>\n      <th>Xenodermichthys_copei<\/th>\n      <th>Notoscopelus_bolini<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="computing-distances-between-species-based-on-functional-traits" class="level2">
<h2 class="anchored" data-anchor-id="computing-distances-between-species-based-on-functional-traits">2.2 Computing distances between species based on functional traits</h2>
<ul>
<li>We have non-continuous traits so we use the <strong>Gower distance</strong> <em>(metric = “gower”)</em> as this method allows traits weighting.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sp_dist_fish <span class="ot">&lt;-</span> mFD<span class="sc">::</span><span class="fu">funct.dist</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sp_tr         =</span> fish_traits,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tr_cat        =</span> fish_traits_cat,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric        =</span> <span class="st">"gower"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale_euclid  =</span> <span class="st">"scale_center"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ordinal_var   =</span> <span class="st">"classic"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_type   =</span> <span class="st">"equal"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">stop_if_NA    =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Output of the function mFD::funct.dist() ----</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(sp_dist_fish, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            Anoplogaster_cornuta Arctozenus_risso
Arctozenus_risso                           0.352                 
Argyropelecus_hemigymnus                   0.354            0.323
Argyropelecus_olfersii                     0.333            0.328
Bathylagus_euryops                         0.336            0.128
Benthosema_glaciale                        0.370            0.149
Bolinichthys_supralateralis                0.282            0.210
Borostomias_antarcticus                    0.287            0.262
Ceratoscopelus_maderensis                  0.347            0.134
Chauliodus_sloani                          0.365            0.382
Cyclothone_sp                              0.322            0.275
Derichthys_serpentinus                     0.545            0.222
Diaphus_metoclampus                        0.330            0.242
Evermannella_balbo                         0.280            0.298
Gonostoma_elongatum                        0.251            0.268
Holtbyrnia_anomala                         0.356            0.176
Holtbyrnia_macrops                         0.379            0.186
Lampanyctus_ater                           0.320            0.138
Lampanyctus_crocodilus                     0.313            0.138
Lampanyctus_macdonaldi                     0.267            0.229
Lestidiops_sphyrenoides                    0.421            0.078
Lobianchia_gemellarii                      0.258            0.201
Malacosteus_niger                          0.225            0.326
Maulisia_argipalla                         0.311            0.193
Maulisia_mauli                             0.304            0.184
Maulisia_microlepis                        0.278            0.180
Maurolicus_muelleri                        0.414            0.215
Melanostigma_atlanticum                    0.401            0.147
Melanostomias_bartonbeani                  0.387            0.335
Myctophum_punctatum                        0.351            0.153
Normichthys_operosus                       0.313            0.183
Notoscopelus_bolini                        0.354            0.120
Notoscopelus_kroyeri                       0.326            0.134
Paralepis_coregonoides                     0.401            0.174
Photostylus_pycnopterus                    0.404            0.225
Sagamichthys_schnakenbecki                 0.380            0.205
Searsia_koefoedi                           0.316            0.145
Serrivomer_beanii                          0.477            0.183
Sigmops_bathyphilus                        0.282            0.223
Stomias_boa                                0.521            0.311
Xenodermichthys_copei                      0.382            0.159
                            Argyropelecus_hemigymnus Argyropelecus_olfersii
Arctozenus_risso                                                           
Argyropelecus_hemigymnus                                                   
Argyropelecus_olfersii                         0.184                       
Bathylagus_euryops                             0.282                  0.288
Benthosema_glaciale                            0.224                  0.257
Bolinichthys_supralateralis                    0.285                  0.262
Borostomias_antarcticus                        0.357                  0.334
Ceratoscopelus_maderensis                      0.239                  0.209
Chauliodus_sloani                              0.380                  0.434
Cyclothone_sp                                  0.300                  0.351
Derichthys_serpentinus                         0.323                  0.391
Diaphus_metoclampus                            0.138                  0.163
Evermannella_balbo                             0.370                  0.392
Gonostoma_elongatum                            0.316                  0.301
Holtbyrnia_anomala                             0.242                  0.193
Holtbyrnia_macrops                             0.196                  0.166
Lampanyctus_ater                               0.255                  0.227
Lampanyctus_crocodilus                         0.257                  0.213
Lampanyctus_macdonaldi                         0.308                  0.265
Lestidiops_sphyrenoides                        0.358                  0.381
Lobianchia_gemellarii                          0.257                  0.233
Malacosteus_niger                              0.491                  0.428
Maulisia_argipalla                             0.231                  0.169
Maulisia_mauli                                 0.243                  0.179
Maulisia_microlepis                            0.306                  0.277
Maurolicus_muelleri                            0.135                  0.191
Melanostigma_atlanticum                        0.342                  0.372
Melanostomias_bartonbeani                      0.514                  0.490
Myctophum_punctatum                            0.236                  0.188
Normichthys_operosus                           0.212                  0.153
Notoscopelus_bolini                            0.239                  0.248
Notoscopelus_kroyeri                           0.232                  0.197
Paralepis_coregonoides                         0.403                  0.415
Photostylus_pycnopterus                        0.203                  0.209
Sagamichthys_schnakenbecki                     0.207                  0.172
Searsia_koefoedi                               0.220                  0.194
Serrivomer_beanii                              0.442                  0.484
Sigmops_bathyphilus                            0.268                  0.255
Stomias_boa                                    0.446                  0.456
Xenodermichthys_copei                          0.300                  0.296
                            Bathylagus_euryops Benthosema_glaciale
Arctozenus_risso                                                  
Argyropelecus_hemigymnus                                          
Argyropelecus_olfersii                                            
Bathylagus_euryops                                                
Benthosema_glaciale                      0.156                    
Bolinichthys_supralateralis              0.165               0.125
Borostomias_antarcticus                  0.249               0.256
Ceratoscopelus_maderensis                0.132               0.081
Chauliodus_sloani                        0.434               0.444
Cyclothone_sp                            0.262               0.252
Derichthys_serpentinus                   0.287               0.244
Diaphus_metoclampus                      0.194               0.135
Evermannella_balbo                       0.314               0.403
Gonostoma_elongatum                      0.252               0.269
Holtbyrnia_anomala                       0.146               0.174
Holtbyrnia_macrops                       0.164               0.120
Lampanyctus_ater                         0.131               0.132
Lampanyctus_crocodilus                   0.160               0.099
Lampanyctus_macdonaldi                   0.204               0.206
Lestidiops_sphyrenoides                  0.163               0.186
Lobianchia_gemellarii                    0.179               0.158
Malacosteus_niger                        0.335               0.409
Maulisia_argipalla                       0.142               0.125
Maulisia_mauli                           0.131               0.125
Maulisia_microlepis                      0.140               0.203
Maurolicus_muelleri                      0.176               0.125
Melanostigma_atlanticum                  0.215               0.249
Melanostomias_bartonbeani                0.422               0.400
Myctophum_punctatum                      0.152               0.084
Normichthys_operosus                     0.141               0.114
Notoscopelus_bolini                      0.134               0.079
Notoscopelus_kroyeri                     0.151               0.083
Paralepis_coregonoides                   0.204               0.244
Photostylus_pycnopterus                  0.226               0.209
Sagamichthys_schnakenbecki               0.144               0.150
Searsia_koefoedi                         0.118               0.102
Serrivomer_beanii                        0.287               0.318
Sigmops_bathyphilus                      0.212               0.190
Stomias_boa                              0.315               0.358
Xenodermichthys_copei                    0.177               0.228
                            Bolinichthys_supralateralis Borostomias_antarcticus
Arctozenus_risso                                                               
Argyropelecus_hemigymnus                                                       
Argyropelecus_olfersii                                                         
Bathylagus_euryops                                                             
Benthosema_glaciale                                                            
Bolinichthys_supralateralis                                                    
Borostomias_antarcticus                           0.270                        
Ceratoscopelus_maderensis                         0.129                   0.214
Chauliodus_sloani                                 0.394                   0.342
Cyclothone_sp                                     0.229                   0.214
Derichthys_serpentinus                            0.317                   0.400
Diaphus_metoclampus                               0.183                   0.261
Evermannella_balbo                                0.351                   0.310
Gonostoma_elongatum                               0.258                   0.177
Holtbyrnia_anomala                                0.218                   0.310
Holtbyrnia_macrops                                0.163                   0.257
Lampanyctus_ater                                  0.123                   0.165
Lampanyctus_crocodilus                            0.118                   0.210
Lampanyctus_macdonaldi                            0.186                   0.154
Lestidiops_sphyrenoides                           0.268                   0.321
Lobianchia_gemellarii                             0.150                   0.135
Malacosteus_niger                                 0.334                   0.291
Maulisia_argipalla                                0.138                   0.192
Maulisia_mauli                                    0.117                   0.183
Maulisia_microlepis                               0.196                   0.252
Maurolicus_muelleri                               0.191                   0.265
Melanostigma_atlanticum                           0.268                   0.379
Melanostomias_bartonbeani                         0.385                   0.220
Myctophum_punctatum                               0.132                   0.225
Normichthys_operosus                              0.124                   0.207
Notoscopelus_bolini                               0.131                   0.207
Notoscopelus_kroyeri                              0.129                   0.213
Paralepis_coregonoides                            0.256                   0.366
Photostylus_pycnopterus                           0.255                   0.285
Sagamichthys_schnakenbecki                        0.146                   0.233
Searsia_koefoedi                                  0.113                   0.193
Serrivomer_beanii                                 0.369                   0.434
Sigmops_bathyphilus                               0.228                   0.126
Stomias_boa                                       0.380                   0.261
Xenodermichthys_copei                             0.246                   0.292
                            Ceratoscopelus_maderensis Chauliodus_sloani
Arctozenus_risso                                                       
Argyropelecus_hemigymnus                                               
Argyropelecus_olfersii                                                 
Bathylagus_euryops                                                     
Benthosema_glaciale                                                    
Bolinichthys_supralateralis                                            
Borostomias_antarcticus                                                
Ceratoscopelus_maderensis                                              
Chauliodus_sloani                               0.411                  
Cyclothone_sp                                   0.230             0.280
Derichthys_serpentinus                          0.257             0.311
Diaphus_metoclampus                             0.153             0.345
Evermannella_balbo                              0.364             0.214
Gonostoma_elongatum                             0.217             0.354
Holtbyrnia_anomala                              0.123             0.458
Holtbyrnia_macrops                              0.072             0.390
Lampanyctus_ater                                0.097             0.379
Lampanyctus_crocodilus                          0.064             0.428
Lampanyctus_macdonaldi                          0.165             0.381
Lestidiops_sphyrenoides                         0.177             0.382
Lobianchia_gemellarii                           0.126             0.353
Malacosteus_niger                               0.370             0.265
Maulisia_argipalla                              0.076             0.434
Maulisia_mauli                                  0.076             0.428
Maulisia_microlepis                             0.156             0.455
Maurolicus_muelleri                             0.131             0.386
Melanostigma_atlanticum                         0.246             0.322
Melanostomias_bartonbeani                       0.345             0.208
Myctophum_punctatum                             0.040             0.433
Normichthys_operosus                            0.062             0.420
Notoscopelus_bolini                             0.062             0.393
Notoscopelus_kroyeri                            0.041             0.401
Paralepis_coregonoides                          0.216             0.415
Photostylus_pycnopterus                         0.197             0.299
Sagamichthys_schnakenbecki                      0.098             0.380
Searsia_koefoedi                                0.050             0.376
Serrivomer_beanii                               0.304             0.410
Sigmops_bathyphilus                             0.160             0.358
Stomias_boa                                     0.306             0.284
Xenodermichthys_copei                           0.234             0.365
                            Cyclothone_sp Derichthys_serpentinus
Arctozenus_risso                                                
Argyropelecus_hemigymnus                                        
Argyropelecus_olfersii                                          
Bathylagus_euryops                                              
Benthosema_glaciale                                             
Bolinichthys_supralateralis                                     
Borostomias_antarcticus                                         
Ceratoscopelus_maderensis                                       
Chauliodus_sloani                                               
Cyclothone_sp                                                   
Derichthys_serpentinus              0.361                       
Diaphus_metoclampus                 0.279                  0.278
Evermannella_balbo                  0.300                  0.389
Gonostoma_elongatum                 0.205                  0.383
Holtbyrnia_anomala                  0.317                  0.284
Holtbyrnia_macrops                  0.270                  0.237
Lampanyctus_ater                    0.209                  0.274
Lampanyctus_crocodilus              0.250                  0.282
Lampanyctus_macdonaldi              0.196                  0.365
Lestidiops_sphyrenoides             0.271                  0.196
Lobianchia_gemellarii               0.179                  0.332
Malacosteus_niger                   0.347                  0.491
Maulisia_argipalla                  0.223                  0.326
Maulisia_mauli                      0.232                  0.323
Maulisia_microlepis                 0.285                  0.374
Maurolicus_muelleri                 0.248                  0.245
Melanostigma_atlanticum             0.295                  0.177
Melanostomias_bartonbeani           0.297                  0.389
Myctophum_punctatum                 0.247                  0.289
Normichthys_operosus                0.223                  0.316
Notoscopelus_bolini                 0.223                  0.239
Notoscopelus_kroyeri                0.225                  0.273
Paralepis_coregonoides              0.280                  0.293
Photostylus_pycnopterus             0.255                  0.207
Sagamichthys_schnakenbecki          0.263                  0.257
Searsia_koefoedi                    0.205                  0.279
Serrivomer_beanii                   0.396                  0.232
Sigmops_bathyphilus                 0.134                  0.351
Stomias_boa                         0.355                  0.292
Xenodermichthys_copei               0.323                  0.222
                            Diaphus_metoclampus Evermannella_balbo
Arctozenus_risso                                                  
Argyropelecus_hemigymnus                                          
Argyropelecus_olfersii                                            
Bathylagus_euryops                                                
Benthosema_glaciale                                               
Bolinichthys_supralateralis                                       
Borostomias_antarcticus                                           
Ceratoscopelus_maderensis                                         
Chauliodus_sloani                                                 
Cyclothone_sp                                                     
Derichthys_serpentinus                                            
Diaphus_metoclampus                                               
Evermannella_balbo                        0.308                   
Gonostoma_elongatum                       0.236              0.347
Holtbyrnia_anomala                        0.175              0.331
Holtbyrnia_macrops                        0.114              0.335
Lampanyctus_ater                          0.168              0.348
Lampanyctus_crocodilus                    0.172              0.385
Lampanyctus_macdonaldi                    0.218              0.336
Lestidiops_sphyrenoides                   0.292              0.361
Lobianchia_gemellarii                     0.172              0.309
Malacosteus_niger                         0.394              0.225
Maulisia_argipalla                        0.155              0.380
Maulisia_mauli                            0.147              0.374
Maulisia_microlepis                       0.212              0.346
Maurolicus_muelleri                       0.113              0.329
Melanostigma_atlanticum                   0.274              0.268
Melanostomias_bartonbeani                 0.455              0.323
Myctophum_punctatum                       0.151              0.388
Normichthys_operosus                      0.142              0.373
Notoscopelus_bolini                       0.147              0.353
Notoscopelus_kroyeri                      0.148              0.365
Paralepis_coregonoides                    0.334              0.307
Photostylus_pycnopterus                   0.150              0.322
Sagamichthys_schnakenbecki                0.101              0.328
Searsia_koefoedi                          0.130              0.335
Serrivomer_beanii                         0.407              0.412
Sigmops_bathyphilus                       0.215              0.342
Stomias_boa                               0.400              0.402
Xenodermichthys_copei                     0.196              0.319
                            Gonostoma_elongatum Holtbyrnia_anomala
Arctozenus_risso                                                  
Argyropelecus_hemigymnus                                          
Argyropelecus_olfersii                                            
Bathylagus_euryops                                                
Benthosema_glaciale                                               
Bolinichthys_supralateralis                                       
Borostomias_antarcticus                                           
Ceratoscopelus_maderensis                                         
Chauliodus_sloani                                                 
Cyclothone_sp                                                     
Derichthys_serpentinus                                            
Diaphus_metoclampus                                               
Evermannella_balbo                                                
Gonostoma_elongatum                                               
Holtbyrnia_anomala                        0.322                   
Holtbyrnia_macrops                        0.265              0.076
Lampanyctus_ater                          0.164              0.200
Lampanyctus_crocodilus                    0.215              0.157
Lampanyctus_macdonaldi                    0.112              0.252
Lestidiops_sphyrenoides                   0.312              0.212
Lobianchia_gemellarii                     0.141              0.225
Malacosteus_niger                         0.289              0.395
Maulisia_argipalla                        0.198              0.140
Maulisia_mauli                            0.190              0.153
Maulisia_microlepis                       0.204              0.196
Maurolicus_muelleri                       0.277              0.151
Melanostigma_atlanticum                   0.381              0.207
Melanostomias_bartonbeani                 0.336              0.459
Myctophum_punctatum                       0.235              0.132
Normichthys_operosus                      0.216              0.134
Notoscopelus_bolini                       0.219              0.161
Notoscopelus_kroyeri                      0.222              0.145
Paralepis_coregonoides                    0.375              0.229
Photostylus_pycnopterus                   0.227              0.232
Sagamichthys_schnakenbecki                0.246              0.111
Searsia_koefoedi                          0.191              0.165
Serrivomer_beanii                         0.391              0.351
Sigmops_bathyphilus                       0.115              0.245
Stomias_boa                               0.401              0.405
Xenodermichthys_copei                     0.279              0.199
                            Holtbyrnia_macrops Lampanyctus_ater
Arctozenus_risso                                               
Argyropelecus_hemigymnus                                       
Argyropelecus_olfersii                                         
Bathylagus_euryops                                             
Benthosema_glaciale                                            
Bolinichthys_supralateralis                                    
Borostomias_antarcticus                                        
Ceratoscopelus_maderensis                                      
Chauliodus_sloani                                              
Cyclothone_sp                                                  
Derichthys_serpentinus                                         
Diaphus_metoclampus                                            
Evermannella_balbo                                             
Gonostoma_elongatum                                            
Holtbyrnia_anomala                                             
Holtbyrnia_macrops                                             
Lampanyctus_ater                         0.143                 
Lampanyctus_crocodilus                   0.100            0.063
Lampanyctus_macdonaldi                   0.199            0.097
Lestidiops_sphyrenoides                  0.231            0.204
Lobianchia_gemellarii                    0.173            0.080
Malacosteus_niger                        0.402            0.328
Maulisia_argipalla                       0.100            0.095
Maulisia_mauli                           0.095            0.078
Maulisia_microlepis                      0.198            0.148
Maurolicus_muelleri                      0.099            0.157
Melanostigma_atlanticum                  0.220            0.265
Melanostomias_bartonbeani                0.396            0.354
Myctophum_punctatum                      0.079            0.115
Normichthys_operosus                     0.092            0.094
Notoscopelus_bolini                      0.100            0.069
Notoscopelus_kroyeri                     0.082            0.095
Paralepis_coregonoides                   0.261            0.261
Photostylus_pycnopterus                  0.178            0.194
Sagamichthys_schnakenbecki               0.055            0.124
Searsia_koefoedi                         0.106            0.064
Serrivomer_beanii                        0.357            0.305
Sigmops_bathyphilus                      0.208            0.118
Stomias_boa                              0.358            0.313
Xenodermichthys_copei                    0.212            0.189
                            Lampanyctus_crocodilus Lampanyctus_macdonaldi
Arctozenus_risso                                                         
Argyropelecus_hemigymnus                                                 
Argyropelecus_olfersii                                                   
Bathylagus_euryops                                                       
Benthosema_glaciale                                                      
Bolinichthys_supralateralis                                              
Borostomias_antarcticus                                                  
Ceratoscopelus_maderensis                                                
Chauliodus_sloani                                                        
Cyclothone_sp                                                            
Derichthys_serpentinus                                                   
Diaphus_metoclampus                                                      
Evermannella_balbo                                                       
Gonostoma_elongatum                                                      
Holtbyrnia_anomala                                                       
Holtbyrnia_macrops                                                       
Lampanyctus_ater                                                         
Lampanyctus_crocodilus                                                   
Lampanyctus_macdonaldi                       0.125                       
Lestidiops_sphyrenoides                      0.205                  0.297
Lobianchia_gemellarii                        0.092                  0.066
Malacosteus_niger                            0.364                  0.312
Maulisia_argipalla                           0.082                  0.133
Maulisia_mauli                               0.068                  0.120
Maulisia_microlepis                          0.165                  0.154
Maurolicus_muelleri                          0.161                  0.223
Melanostigma_atlanticum                      0.268                  0.357
Melanostomias_bartonbeani                    0.366                  0.341
Myctophum_punctatum                          0.068                  0.177
Normichthys_operosus                         0.082                  0.144
Notoscopelus_bolini                          0.057                  0.151
Notoscopelus_kroyeri                         0.046                  0.148
Paralepis_coregonoides                       0.259                  0.335
Photostylus_pycnopterus                      0.236                  0.271
Sagamichthys_schnakenbecki                   0.121                  0.182
Searsia_koefoedi                             0.073                  0.132
Serrivomer_beanii                            0.311                  0.390
Sigmops_bathyphilus                          0.155                  0.091
Stomias_boa                                  0.358                  0.388
Xenodermichthys_copei                        0.230                  0.265
                            Lestidiops_sphyrenoides Lobianchia_gemellarii
Arctozenus_risso                                                         
Argyropelecus_hemigymnus                                                 
Argyropelecus_olfersii                                                   
Bathylagus_euryops                                                       
Benthosema_glaciale                                                      
Bolinichthys_supralateralis                                              
Borostomias_antarcticus                                                  
Ceratoscopelus_maderensis                                                
Chauliodus_sloani                                                        
Cyclothone_sp                                                            
Derichthys_serpentinus                                                   
Diaphus_metoclampus                                                      
Evermannella_balbo                                                       
Gonostoma_elongatum                                                      
Holtbyrnia_anomala                                                       
Holtbyrnia_macrops                                                       
Lampanyctus_ater                                                         
Lampanyctus_crocodilus                                                   
Lampanyctus_macdonaldi                                                   
Lestidiops_sphyrenoides                                                  
Lobianchia_gemellarii                         0.266                      
Malacosteus_niger                             0.367                 0.302
Maulisia_argipalla                            0.246                 0.117
Maulisia_mauli                                0.237                 0.100
Maulisia_microlepis                           0.222                 0.175
Maurolicus_muelleri                           0.241                 0.182
Melanostigma_atlanticum                       0.147                 0.322
Melanostomias_bartonbeani                     0.358                 0.337
Myctophum_punctatum                           0.201                 0.133
Normichthys_operosus                          0.233                 0.112
Notoscopelus_bolini                           0.178                 0.103
Notoscopelus_kroyeri                          0.198                 0.119
Paralepis_coregonoides                        0.179                 0.310
Photostylus_pycnopterus                       0.226                 0.240
Sagamichthys_schnakenbecki                    0.244                 0.159
Searsia_koefoedi                              0.206                 0.095
Serrivomer_beanii                             0.215                 0.366
Sigmops_bathyphilus                           0.273                 0.084
Stomias_boa                                   0.270                 0.371
Xenodermichthys_copei                         0.200                 0.232
                            Malacosteus_niger Maulisia_argipalla Maulisia_mauli
Arctozenus_risso                                                               
Argyropelecus_hemigymnus                                                       
Argyropelecus_olfersii                                                         
Bathylagus_euryops                                                             
Benthosema_glaciale                                                            
Bolinichthys_supralateralis                                                    
Borostomias_antarcticus                                                        
Ceratoscopelus_maderensis                                                      
Chauliodus_sloani                                                              
Cyclothone_sp                                                                  
Derichthys_serpentinus                                                         
Diaphus_metoclampus                                                            
Evermannella_balbo                                                             
Gonostoma_elongatum                                                            
Holtbyrnia_anomala                                                             
Holtbyrnia_macrops                                                             
Lampanyctus_ater                                                               
Lampanyctus_crocodilus                                                         
Lampanyctus_macdonaldi                                                         
Lestidiops_sphyrenoides                                                        
Lobianchia_gemellarii                                                          
Malacosteus_niger                                                              
Maulisia_argipalla                      0.345                                  
Maulisia_mauli                          0.326              0.030               
Maulisia_microlepis                     0.316              0.145          0.127
Maurolicus_muelleri                     0.432              0.134          0.141
Melanostigma_atlanticum                 0.362              0.307          0.303
Melanostomias_bartonbeani               0.217              0.376          0.374
Myctophum_punctatum                     0.378              0.072          0.076
Normichthys_operosus                    0.360              0.036          0.043
Notoscopelus_bolini                     0.367              0.108          0.097
Notoscopelus_kroyeri                    0.381              0.074          0.076
Paralepis_coregonoides                  0.315              0.261          0.268
Photostylus_pycnopterus                 0.410              0.225          0.219
Sagamichthys_schnakenbecki              0.390              0.092          0.084
Searsia_koefoedi                        0.349              0.076          0.067
Serrivomer_beanii                       0.437              0.352          0.355
Sigmops_bathyphilus                     0.313              0.126          0.139
Stomias_boa                             0.323              0.328          0.324
Xenodermichthys_copei                   0.393              0.233          0.227
                            Maulisia_microlepis Maurolicus_muelleri
Arctozenus_risso                                                   
Argyropelecus_hemigymnus                                           
Argyropelecus_olfersii                                             
Bathylagus_euryops                                                 
Benthosema_glaciale                                                
Bolinichthys_supralateralis                                        
Borostomias_antarcticus                                            
Ceratoscopelus_maderensis                                          
Chauliodus_sloani                                                  
Cyclothone_sp                                                      
Derichthys_serpentinus                                             
Diaphus_metoclampus                                                
Evermannella_balbo                                                 
Gonostoma_elongatum                                                
Holtbyrnia_anomala                                                 
Holtbyrnia_macrops                                                 
Lampanyctus_ater                                                   
Lampanyctus_crocodilus                                             
Lampanyctus_macdonaldi                                             
Lestidiops_sphyrenoides                                            
Lobianchia_gemellarii                                              
Malacosteus_niger                                                  
Maulisia_argipalla                                                 
Maulisia_mauli                                                     
Maulisia_microlepis                                                
Maurolicus_muelleri                       0.224                    
Melanostigma_atlanticum                   0.293               0.224
Melanostomias_bartonbeani                 0.406               0.431
Myctophum_punctatum                       0.171               0.132
Normichthys_operosus                      0.156               0.125
Notoscopelus_bolini                       0.180               0.151
Notoscopelus_kroyeri                      0.163               0.132
Paralepis_coregonoides                    0.263               0.283
Photostylus_pycnopterus                   0.256               0.165
Sagamichthys_schnakenbecki                0.187               0.091
Searsia_koefoedi                          0.139               0.117
Serrivomer_beanii                         0.327               0.395
Sigmops_bathyphilus                       0.199               0.195
Stomias_boa                               0.368               0.356
Xenodermichthys_copei                     0.213               0.212
                            Melanostigma_atlanticum Melanostomias_bartonbeani
Arctozenus_risso                                                             
Argyropelecus_hemigymnus                                                     
Argyropelecus_olfersii                                                       
Bathylagus_euryops                                                           
Benthosema_glaciale                                                          
Bolinichthys_supralateralis                                                  
Borostomias_antarcticus                                                      
Ceratoscopelus_maderensis                                                    
Chauliodus_sloani                                                            
Cyclothone_sp                                                                
Derichthys_serpentinus                                                       
Diaphus_metoclampus                                                          
Evermannella_balbo                                                           
Gonostoma_elongatum                                                          
Holtbyrnia_anomala                                                           
Holtbyrnia_macrops                                                           
Lampanyctus_ater                                                             
Lampanyctus_crocodilus                                                       
Lampanyctus_macdonaldi                                                       
Lestidiops_sphyrenoides                                                      
Lobianchia_gemellarii                                                        
Malacosteus_niger                                                            
Maulisia_argipalla                                                           
Maulisia_mauli                                                               
Maulisia_microlepis                                                          
Maurolicus_muelleri                                                          
Melanostigma_atlanticum                                                      
Melanostomias_bartonbeani                     0.353                          
Myctophum_punctatum                           0.267                     0.356
Normichthys_operosus                          0.297                     0.378
Notoscopelus_bolini                           0.238                     0.363
Notoscopelus_kroyeri                          0.254                     0.349
Paralepis_coregonoides                        0.173                     0.341
Photostylus_pycnopterus                       0.223                     0.375
Sagamichthys_schnakenbecki                    0.244                     0.415
Searsia_koefoedi                              0.264                     0.364
Serrivomer_beanii                             0.276                     0.414
Sigmops_bathyphilus                           0.336                     0.301
Stomias_boa                                   0.355                     0.187
Xenodermichthys_copei                         0.187                     0.424
                            Myctophum_punctatum Normichthys_operosus
Arctozenus_risso                                                    
Argyropelecus_hemigymnus                                            
Argyropelecus_olfersii                                              
Bathylagus_euryops                                                  
Benthosema_glaciale                                                 
Bolinichthys_supralateralis                                         
Borostomias_antarcticus                                             
Ceratoscopelus_maderensis                                           
Chauliodus_sloani                                                   
Cyclothone_sp                                                       
Derichthys_serpentinus                                              
Diaphus_metoclampus                                                 
Evermannella_balbo                                                  
Gonostoma_elongatum                                                 
Holtbyrnia_anomala                                                  
Holtbyrnia_macrops                                                  
Lampanyctus_ater                                                    
Lampanyctus_crocodilus                                              
Lampanyctus_macdonaldi                                              
Lestidiops_sphyrenoides                                             
Lobianchia_gemellarii                                               
Malacosteus_niger                                                   
Maulisia_argipalla                                                  
Maulisia_mauli                                                      
Maulisia_microlepis                                                 
Maurolicus_muelleri                                                 
Melanostigma_atlanticum                                             
Melanostomias_bartonbeani                                           
Myctophum_punctatum                                                 
Normichthys_operosus                      0.046                     
Notoscopelus_bolini                       0.074                0.103
Notoscopelus_kroyeri                      0.046                0.062
Paralepis_coregonoides                    0.240                0.265
Photostylus_pycnopterus                   0.214                0.203
Sagamichthys_schnakenbecki                0.102                0.095
Searsia_koefoedi                          0.083                0.061
Serrivomer_beanii                         0.329                0.350
Sigmops_bathyphilus                       0.176                0.144
Stomias_boa                               0.333                0.322
Xenodermichthys_copei                     0.238                0.237
                            Notoscopelus_bolini Notoscopelus_kroyeri
Arctozenus_risso                                                    
Argyropelecus_hemigymnus                                            
Argyropelecus_olfersii                                              
Bathylagus_euryops                                                  
Benthosema_glaciale                                                 
Bolinichthys_supralateralis                                         
Borostomias_antarcticus                                             
Ceratoscopelus_maderensis                                           
Chauliodus_sloani                                                   
Cyclothone_sp                                                       
Derichthys_serpentinus                                              
Diaphus_metoclampus                                                 
Evermannella_balbo                                                  
Gonostoma_elongatum                                                 
Holtbyrnia_anomala                                                  
Holtbyrnia_macrops                                                  
Lampanyctus_ater                                                    
Lampanyctus_crocodilus                                              
Lampanyctus_macdonaldi                                              
Lestidiops_sphyrenoides                                             
Lobianchia_gemellarii                                               
Malacosteus_niger                                                   
Maulisia_argipalla                                                  
Maulisia_mauli                                                      
Maulisia_microlepis                                                 
Maurolicus_muelleri                                                 
Melanostigma_atlanticum                                             
Melanostomias_bartonbeani                                           
Myctophum_punctatum                                                 
Normichthys_operosus                                                
Notoscopelus_bolini                                                 
Notoscopelus_kroyeri                      0.067                     
Paralepis_coregonoides                    0.228                0.249
Photostylus_pycnopterus                   0.214                0.213
Sagamichthys_schnakenbecki                0.127                0.117
Searsia_koefoedi                          0.074                0.052
Serrivomer_beanii                         0.286                0.294
Sigmops_bathyphilus                       0.166                0.151
Stomias_boa                               0.324                0.341
Xenodermichthys_copei                     0.204                0.231
                            Paralepis_coregonoides  Photostylus_pycnopterus
Arctozenus_risso                                                           
Argyropelecus_hemigymnus                                                   
Argyropelecus_olfersii                                                     
Bathylagus_euryops                                                         
Benthosema_glaciale                                                        
Bolinichthys_supralateralis                                                
Borostomias_antarcticus                                                    
Ceratoscopelus_maderensis                                                  
Chauliodus_sloani                                                          
Cyclothone_sp                                                              
Derichthys_serpentinus                                                     
Diaphus_metoclampus                                                        
Evermannella_balbo                                                         
Gonostoma_elongatum                                                        
Holtbyrnia_anomala                                                         
Holtbyrnia_macrops                                                         
Lampanyctus_ater                                                           
Lampanyctus_crocodilus                                                     
Lampanyctus_macdonaldi                                                     
Lestidiops_sphyrenoides                                                    
Lobianchia_gemellarii                                                      
Malacosteus_niger                                                          
Maulisia_argipalla                                                         
Maulisia_mauli                                                             
Maulisia_microlepis                                                        
Maurolicus_muelleri                                                        
Melanostigma_atlanticum                                                    
Melanostomias_bartonbeani                                                  
Myctophum_punctatum                                                        
Normichthys_operosus                                                       
Notoscopelus_bolini                                                        
Notoscopelus_kroyeri                                                       
Paralepis_coregonoides                                                     
Photostylus_pycnopterus                       0.335                        
Sagamichthys_schnakenbecki                    0.269                   0.170
Searsia_koefoedi                              0.255                   0.184
Serrivomer_beanii                             0.305                   0.337
Sigmops_bathyphilus                           0.305                   0.224
Stomias_boa                                   0.352                   0.308
Xenodermichthys_copei                         0.311                   0.159
                            Sagamichthys_schnakenbecki Searsia_koefoedi
Arctozenus_risso                                                       
Argyropelecus_hemigymnus                                               
Argyropelecus_olfersii                                                 
Bathylagus_euryops                                                     
Benthosema_glaciale                                                    
Bolinichthys_supralateralis                                            
Borostomias_antarcticus                                                
Ceratoscopelus_maderensis                                              
Chauliodus_sloani                                                      
Cyclothone_sp                                                          
Derichthys_serpentinus                                                 
Diaphus_metoclampus                                                    
Evermannella_balbo                                                     
Gonostoma_elongatum                                                    
Holtbyrnia_anomala                                                     
Holtbyrnia_macrops                                                     
Lampanyctus_ater                                                       
Lampanyctus_crocodilus                                                 
Lampanyctus_macdonaldi                                                 
Lestidiops_sphyrenoides                                                
Lobianchia_gemellarii                                                  
Malacosteus_niger                                                      
Maulisia_argipalla                                                     
Maulisia_mauli                                                         
Maulisia_microlepis                                                    
Maurolicus_muelleri                                                    
Melanostigma_atlanticum                                                
Melanostomias_bartonbeani                                              
Myctophum_punctatum                                                    
Normichthys_operosus                                                   
Notoscopelus_bolini                                                    
Notoscopelus_kroyeri                                                   
Paralepis_coregonoides                                                 
Photostylus_pycnopterus                                                
Sagamichthys_schnakenbecki                                             
Searsia_koefoedi                                 0.102                 
Serrivomer_beanii                                0.380            0.304
Sigmops_bathyphilus                              0.190            0.131
Stomias_boa                                      0.338            0.303
Xenodermichthys_copei                            0.182            0.217
                            Serrivomer_beanii Sigmops_bathyphilus Stomias_boa
Arctozenus_risso                                                             
Argyropelecus_hemigymnus                                                     
Argyropelecus_olfersii                                                       
Bathylagus_euryops                                                           
Benthosema_glaciale                                                          
Bolinichthys_supralateralis                                                  
Borostomias_antarcticus                                                      
Ceratoscopelus_maderensis                                                    
Chauliodus_sloani                                                            
Cyclothone_sp                                                                
Derichthys_serpentinus                                                       
Diaphus_metoclampus                                                          
Evermannella_balbo                                                           
Gonostoma_elongatum                                                          
Holtbyrnia_anomala                                                           
Holtbyrnia_macrops                                                           
Lampanyctus_ater                                                             
Lampanyctus_crocodilus                                                       
Lampanyctus_macdonaldi                                                       
Lestidiops_sphyrenoides                                                      
Lobianchia_gemellarii                                                        
Malacosteus_niger                                                            
Maulisia_argipalla                                                           
Maulisia_mauli                                                               
Maulisia_microlepis                                                          
Maurolicus_muelleri                                                          
Melanostigma_atlanticum                                                      
Melanostomias_bartonbeani                                                    
Myctophum_punctatum                                                          
Normichthys_operosus                                                         
Notoscopelus_bolini                                                          
Notoscopelus_kroyeri                                                         
Paralepis_coregonoides                                                       
Photostylus_pycnopterus                                                      
Sagamichthys_schnakenbecki                                                   
Searsia_koefoedi                                                             
Serrivomer_beanii                                                            
Sigmops_bathyphilus                     0.369                                
Stomias_boa                             0.370               0.362            
Xenodermichthys_copei                   0.264               0.251       0.384</code></pre>
</div>
</div>
</section>
<section id="building-functional-spaces-and-chosing-the-best-one" class="level2">
<h2 class="anchored" data-anchor-id="building-functional-spaces-and-chosing-the-best-one">2.3 Building functional spaces and chosing the best one</h2>
<section id="computing-several-multimensional-functional-spaces-and-assessing-their-quality" class="level3">
<h3 class="anchored" data-anchor-id="computing-several-multimensional-functional-spaces-and-assessing-their-quality">2.3.1 Computing several multimensional functional spaces and assessing their quality</h3>
<ul>
<li>mFD evaluates the quality of PCoA-based multidimensional spaces according to the deviation between trait-based distances and distances in the functional space (extension of Maire et al.&nbsp;(2015) framework).</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fspaces_quality_fish <span class="ot">&lt;-</span> mFD<span class="sc">::</span><span class="fu">quality.fspaces</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sp_dist             =</span> sp_dist_fish,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxdim_pcoa         =</span> <span class="dv">10</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">deviation_weighting =</span> <span class="st">"absolute"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fdist_scaling       =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fdendro             =</span> <span class="st">"average"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Quality metrics of functional spaces ----</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(fspaces_quality_fish<span class="sc">$</span><span class="st">"quality_fspaces"</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               mad
pcoa_1d      0.129
pcoa_2d      0.071
pcoa_3d      0.044
pcoa_4d      0.028
pcoa_5d      0.020
pcoa_6d      0.015
pcoa_7d      0.015
pcoa_8d      0.016
pcoa_9d      0.017
pcoa_10d     0.019
tree_average 0.039</code></pre>
</div>
</div>
<p>The space with the best quality has the lowest quality metric. 5-D space good ?</p>
</section>
<section id="illustrating-the-quality-of-the-functional-spaces" class="level3">
<h3 class="anchored" data-anchor-id="illustrating-the-quality-of-the-functional-spaces">2.3.2 Illustrating the quality of the functional spaces</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mFD<span class="sc">::</span><span class="fu">quality.fspaces.plot</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fspaces_quality            =</span> fspaces_quality_fish,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">quality_metric             =</span> <span class="st">"mad"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fspaces_plot               =</span> <span class="fu">c</span>(<span class="st">"tree_average"</span>, <span class="st">"pcoa_2d"</span>, <span class="st">"pcoa_3d"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"pcoa_4d"</span>, <span class="st">"pcoa_5d"</span>, <span class="st">"pcoa_6d"</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">name_file                  =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">range_dist                 =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">range_dev                  =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">range_qdev                 =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">gradient_deviation         =</span> <span class="fu">c</span>(<span class="at">neg =</span> <span class="st">"darkblue"</span>, <span class="at">nul =</span> <span class="st">"grey80"</span>, <span class="at">pos =</span> <span class="st">"darkred"</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">gradient_deviation_quality =</span> <span class="fu">c</span>(<span class="at">low =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_lab                      =</span> <span class="st">"Trait-based distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/fspaces_quality_plot-1.png" class="img-fluid" width="1248"></p>
</div>
</div>
<p>This function generates a figure with three panels (in rows) for each selected functional space (in columns). Each column represents a functional space, the value of the quality metric is written on the top of each column. The x-axis of all panels represents trait-based distances. The y-axis is different for each row:</p>
<ul>
<li>on the first (top) row, the y-axis represents species functional distances in the multidimensional space. Thus, the closer species are to the 1:1 line, the better distances in the functional space fit trait-based ones.</li>
<li>on the second row, the y-axis shows the raw deviation of species distances in the functional space compared to trait-based distances. Thus, the raw deviation reflects the distance to the horizontal line.</li>
<li>on the third row (bottom), the y-axis shows the absolute or squared deviation of the (“scaled”) distance in the functional space. It is the deviation that is taken into account for computing the quality metric.</li>
</ul>
</section>
<section id="testing-the-correlation-between-functional-axes-and-traits" class="level3">
<h3 class="anchored" data-anchor-id="testing-the-correlation-between-functional-axes-and-traits">2.3.3 Testing the correlation between functional axes and traits</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sp_faxes_coord_fish <span class="ot">&lt;-</span> fspaces_quality_fish<span class="sc">$</span><span class="st">"details_fspaces"</span><span class="sc">$</span><span class="st">"sp_pc_coord"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fish_tr_faxes &lt;- mFD::traits.faxes.cor(</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   sp_tr          = fish_traits, </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   sp_faxes_coord = sp_faxes_coord_fish[ , c("PC1", "PC2", "PC3", "PC4")], </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot           = F)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Print traits with significant effect ----</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fish_tr_faxes$"tr_faxes_stat"[which(fish_tr_faxes$"tr_faxes_stat"$"p.value" &lt; 0.05), ]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="plotting-the-selected-functional-space-and-position-of-species" class="level2">
<h2 class="anchored" data-anchor-id="plotting-the-selected-functional-space-and-position-of-species">2.4 Plotting the selected functional space and position of species</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sp_faxes_coord_fish &lt;- fspaces_quality_fish$"details_fspaces"$"sp_pc_coord"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># big_plot &lt;- mFD::funct.space.plot(</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   sp_faxes_coord  = sp_faxes_coord_fish[ , c("PC1", "PC2", "PC3", "PC4")],</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   faxes           = c("PC1", "PC2", "PC3", "PC4"),</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   name_file       = NULL,</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   faxes_nm        = NULL,</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   range_faxes     = c(NA, NA),</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_ch         = TRUE,</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_vertices   = TRUE,</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_sp_nm      = NULL,</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   check_input     = TRUE)</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># big_plot$"patchwork"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="computing-and-plotting-fd-indices-using-the-mfd-package" class="level1">
<h1>3. Computing and plotting FD indices using the mFD package</h1>
<section id="computing-and-plotting-alpha-fd-indices" class="level2">
<h2 class="anchored" data-anchor-id="computing-and-plotting-alpha-fd-indices">3.1 Computing and plotting alpha FD indices</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>alpha_fd_indices_fish <span class="ot">&lt;-</span> mFD<span class="sc">::</span><span class="fu">alpha.fd.multidim</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sp_faxes_coord   =</span> sp_faxes_coord_fish[ , <span class="fu">c</span>(<span class="st">"PC1"</span>, <span class="st">"PC2"</span>, <span class="st">"PC3"</span>, <span class="st">"PC4"</span>)],</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">asb_sp_w         =</span> depth_fish_biomass,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_vect         =</span> <span class="fu">c</span>(<span class="st">"fdis"</span>, <span class="st">"fric"</span>, <span class="st">"fdiv"</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"fspe"</span>, <span class="st">"fide"</span>),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaling          =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">check_input      =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">details_returned =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The function has two main outputs:</p>
<ul>
<li>a data.frame gathering indices values in each assemblage (for FIde values, there are as many columns as there are axes to the studied functional space).</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fd_ind_values_fish <span class="ot">&lt;-</span> alpha_fd_indices_fish<span class="sc">$</span><span class="st">"functional_diversity_indices"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">tagList</span>(DT<span class="sc">::</span><span class="fu">datatable</span>(fd_ind_values_fish))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7218e881fc4a8599bbea" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7218e881fc4a8599bbea">{"x":{"filter":"none","vertical":false,"data":[["Upper mesopelagic","Bathypelagic","Epipelagic","Lower mesopelagic"],[26,38,18,29],[0.3819164720301633,0.2243253503720049,0.2446625873605787,0.3886067466899954],[0.6012988578872813,0.8789237490675231,0.0754571432815377,0.5050769961744795],[0.5790784216741277,0.477576253963031,0.6319059400530773,0.6149599312212776],[0.3500983697751718,0.31322282063433,0.3168508413427947,0.3450784782052695],[-0.04771379074690088,0.04770084145993005,-0.06521922096268024,-0.03773467190579252],[-0.02855512352540044,0.04358899021220848,-0.02642033128167787,-0.02863067280483439],[0.004495240490256234,0.00297892635947409,-0.02722190067401664,-0.01081275021599532],[-0.01966683219535953,0.03417990419712141,0.01266014702671997,-0.01078836195960942]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sp_richn<\/th>\n      <th>fdis<\/th>\n      <th>fric<\/th>\n      <th>fdiv<\/th>\n      <th>fspe<\/th>\n      <th>fide_PC1<\/th>\n      <th>fide_PC2<\/th>\n      <th>fide_PC3<\/th>\n      <th>fide_PC4<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li>a details list of data.frames and lists gathering information such as coordinates of centroids, distances and identity of the nearest neighbour, distances to the centroid, etc. The user does not have to directly use it but it will be useful if FD indices are then plotted. It can be retrieved through:</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>details_list_fish <span class="ot">&lt;-</span> alpha_fd_indices_fish<span class="sc">$</span><span class="st">"details"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plots_alpha <span class="ot">&lt;-</span> mFD<span class="sc">::</span><span class="fu">alpha.multidim.plot</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_alpha_fd_multidim =</span> alpha_fd_indices_fish,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_asb_nm              =</span> <span class="fu">c</span>(<span class="st">"Epipelagic"</span>, <span class="st">"Bathypelagic"</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_nm                   =</span> <span class="fu">c</span>(<span class="st">"fdis"</span>, <span class="st">"fric"</span>, <span class="st">"fdiv"</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"fspe"</span>, <span class="st">"fide"</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">faxes                    =</span> <span class="cn">NULL</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">faxes_nm                 =</span> <span class="cn">NULL</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">range_faxes              =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_sp_nm               =</span> <span class="cn">NULL</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_file                =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">check_input              =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fric-functional-richness" class="level3">
<h3 class="anchored" data-anchor-id="fric-functional-richness"><strong>FRic Functional Richness</strong></h3>
<ul>
<li>the proportion of functional space filled by species of the studied assemblage, i.e.&nbsp;the volume inside the convex-hull shaping species. To compute FRic the number of species must be at least higher than the number of functional axis + 1.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plots_alpha<span class="sc">$</span><span class="st">"fric"</span><span class="sc">$</span><span class="st">"patchwork"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_FRic-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
</section>
<section id="fdiv-functional-divergence" class="level3">
<h3 class="anchored" data-anchor-id="fdiv-functional-divergence"><strong>FDiv Functional Divergence</strong></h3>
<ul>
<li>the proportion of the biomass supported by the species with the most extreme functional traits i.e.&nbsp;the ones located close to the edge of the convex-hull filled by the assemblage</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plots_alpha<span class="sc">$</span><span class="st">"fdiv"</span><span class="sc">$</span><span class="st">"patchwork"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_FDiv-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
</section>
<section id="fspe-functional-specialization" class="level3">
<h3 class="anchored" data-anchor-id="fspe-functional-specialization"><strong>FSpe Functional Specialization</strong></h3>
<ul>
<li>the biomass weighted mean distance to the mean position of species from the global pool (present in all assemblages).</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plots_alpha<span class="sc">$</span><span class="st">"fspe"</span><span class="sc">$</span><span class="st">"patchwork"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_FSpe-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
</section>
<section id="fdis-functional-dispersion" class="level3">
<h3 class="anchored" data-anchor-id="fdis-functional-dispersion"><strong>FDis Functional Dispersion</strong></h3>
<ul>
<li>the biomass weighted deviation of species traits values from the center of the functional space filled by the assemblage i.e.&nbsp;the biomass-weighted mean distance to the biomass-weighted mean trait values of the assemblage.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plots_alpha<span class="sc">$</span><span class="st">"fdis"</span><span class="sc">$</span><span class="st">"patchwork"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_FDis-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
</section>
<section id="fide-functional-identity" class="level3">
<h3 class="anchored" data-anchor-id="fide-functional-identity"><strong>FIde Functional Identity</strong></h3>
<ul>
<li>the mean traits values for the assemblage. FIde is always computed when FDis is computed.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plots_alpha<span class="sc">$</span><span class="st">"fide"</span><span class="sc">$</span><span class="st">"patchwork"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_FIde-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
</section>
</section>
<section id="computing-and-plotting-beta-fd-indices" class="level2">
<h2 class="anchored" data-anchor-id="computing-and-plotting-beta-fd-indices">3.2.Computing and plotting beta FD indices</h2>
<ul>
<li>The function returns a list containing:</li>
<li>a dist object with beta indices values for each pair of assemblages:</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>beta_fd_indices_fish <span class="ot">&lt;-</span> mFD<span class="sc">::</span><span class="fu">beta.fd.multidim</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">sp_faxes_coord   =</span> sp_faxes_coord_fish[ , <span class="fu">c</span>(<span class="st">"PC1"</span>, <span class="st">"PC2"</span>, <span class="st">"PC3"</span>, <span class="st">"PC4"</span>)],</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">asb_sp_occ       =</span> asb_sp_fish_occ,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">check_input      =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta_family      =</span> <span class="fu">c</span>(<span class="st">"Jaccard"</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">details_returned =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Serial computing of convex hulls shaping assemblages with conv1

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================================| 100%
Serial computing of intersections between pairs of assemblages with inter_geom_coord

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(beta_fd_indices_fish<span class="sc">$</span><span class="st">"pairasb_fbd_indices"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$jac_diss
                  Upper mesopelagic Bathypelagic Epipelagic
Bathypelagic              0.3158691                        
Epipelagic                0.8745098    0.9141482           
Lower mesopelagic         0.1820053    0.4253461  0.8506027

$jac_turn
                  Upper mesopelagic Bathypelagic   Epipelagic
Bathypelagic           7.006867e-16                          
Epipelagic             0.000000e+00 0.000000e+00             
Lower mesopelagic      2.838112e-02 4.170870e-15 0.000000e+00

$jac_nest
                  Upper mesopelagic Bathypelagic Epipelagic
Bathypelagic              0.3158691                        
Epipelagic                0.8745098    0.9141482           
Lower mesopelagic         0.1536242    0.4253461  0.8506027</code></pre>
</div>
</div>
<ul>
<li>a vector containing the FRic value for each assemblage retrieved through the details_beta list:</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>beta_fd_indices_fish<span class="sc">$</span><span class="st">"details"</span><span class="sc">$</span><span class="st">"asb_FRic"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Upper mesopelagic      Bathypelagic        Epipelagic Lower mesopelagic 
       0.68413086        1.00000000        0.08585175        0.57465394 </code></pre>
</div>
</div>
<ul>
<li>a list of vectors containing names of species being vertices of the convex hull for each assemblage retrieved through the details_beta list:</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>beta_fd_indices_fish<span class="sc">$</span><span class="st">"details"</span><span class="sc">$</span><span class="st">"asb_vertices"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`Upper mesopelagic`
 [1] "Serrivomer_beanii"         "Borostomias_antarcticus"  
 [3] "Melanostigma_atlanticum"   "Argyropelecus_hemigymnus" 
 [5] "Myctophum_punctatum"       "Malacosteus_niger"        
 [7] "Lestidiops_sphyrenoides"   "Lampanyctus_crocodilus"   
 [9] "Benthosema_glaciale"       "Maulisia_mauli"           
[11] "Arctozenus_risso"          "Maurolicus_muelleri"      
[13] "Lobianchia_gemellarii"     "Xenodermichthys_copei"    
[15] "Chauliodus_sloani"         "Evermannella_balbo"       
[17] "Derichthys_serpentinus"    "Melanostomias_bartonbeani"
[19] "Argyropelecus_olfersii"   

$Bathypelagic
 [1] "Borostomias_antarcticus"   "Argyropelecus_hemigymnus" 
 [3] "Myctophum_punctatum"       "Lampanyctus_macdonaldi"   
 [5] "Serrivomer_beanii"         "Photostylus_pycnopterus"  
 [7] "Maurolicus_muelleri"       "Maulisia_argipalla"       
 [9] "Benthosema_glaciale"       "Holtbyrnia_anomala"       
[11] "Malacosteus_niger"         "Lampanyctus_crocodilus"   
[13] "Lestidiops_sphyrenoides"   "Melanostigma_atlanticum"  
[15] "Chauliodus_sloani"         "Anoplogaster_cornuta"     
[17] "Evermannella_balbo"        "Maulisia_microlepis"      
[19] "Derichthys_serpentinus"    "Melanostomias_bartonbeani"
[21] "Argyropelecus_olfersii"   

$Epipelagic
 [1] "Maurolicus_muelleri"       "Xenodermichthys_copei"    
 [3] "Lestidiops_sphyrenoides"   "Cyclothone_sp"            
 [5] "Arctozenus_risso"          "Benthosema_glaciale"      
 [7] "Lampanyctus_crocodilus"    "Myctophum_punctatum"      
 [9] "Melanostigma_atlanticum"   "Lobianchia_gemellarii"    
[11] "Melanostomias_bartonbeani" "Serrivomer_beanii"        
[13] "Argyropelecus_olfersii"   

$`Lower mesopelagic`
 [1] "Serrivomer_beanii"           "Borostomias_antarcticus"    
 [3] "Melanostigma_atlanticum"     "Argyropelecus_hemigymnus"   
 [5] "Myctophum_punctatum"         "Gonostoma_elongatum"        
 [7] "Xenodermichthys_copei"       "Lestidiops_sphyrenoides"    
 [9] "Lampanyctus_crocodilus"      "Benthosema_glaciale"        
[11] "Arctozenus_risso"            "Maulisia_argipalla"         
[13] "Bolinichthys_supralateralis" "Maurolicus_muelleri"        
[15] "Maulisia_mauli"              "Chauliodus_sloani"          
[17] "Evermannella_balbo"          "Derichthys_serpentinus"     
[19] "Melanostomias_bartonbeani"   "Argyropelecus_olfersii"     </code></pre>
</div>
</div>
<ul>
<li>overlap between convex hulls shaping each of the two species assemblages.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>beta_plot_fish <span class="ot">&lt;-</span> mFD<span class="sc">::</span><span class="fu">beta.multidim.plot</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_beta_fd_multidim =</span> beta_fd_indices_fish,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_asb_nm             =</span> <span class="fu">c</span>(<span class="st">"Epipelagic"</span>, <span class="st">"Upper mesopelagic"</span>),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_family             =</span> <span class="fu">c</span>(<span class="st">"Jaccard"</span>),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_sp_nm              =</span> <span class="fu">c</span>(<span class="st">"Maurolicus_muelleri"</span>, <span class="st">"Notoscopelus_bolini"</span>, <span class="st">"Lampanyctus_ater"</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">faxes                   =</span> <span class="fu">paste0</span>(<span class="st">"PC"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">name_file               =</span> <span class="cn">NULL</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">faxes_nm                =</span> <span class="cn">NULL</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">range_faxes             =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">check_input             =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>beta_plot_fish<span class="sc">$</span><span class="st">"patchwork"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_beta_FD_epi_up-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>beta_plot_fish <span class="ot">&lt;-</span> mFD<span class="sc">::</span><span class="fu">beta.multidim.plot</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_beta_fd_multidim =</span> beta_fd_indices_fish,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_asb_nm             =</span> <span class="fu">c</span>(<span class="st">"Upper mesopelagic"</span>, <span class="st">"Lower mesopelagic"</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_family             =</span> <span class="fu">c</span>(<span class="st">"Jaccard"</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_sp_nm              =</span> <span class="fu">c</span>(<span class="st">"Maulisia_mauli"</span>, <span class="st">"Evermannella_balbo"</span>, <span class="st">"Borostomias_antarcticus"</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">faxes                   =</span> <span class="fu">paste0</span>(<span class="st">"PC"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">name_file               =</span> <span class="cn">NULL</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">faxes_nm                =</span> <span class="cn">NULL</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">range_faxes             =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">check_input             =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>beta_plot_fish<span class="sc">$</span><span class="st">"patchwork"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_beta_FD_up_lw-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>beta_plot_fish <span class="ot">&lt;-</span> mFD<span class="sc">::</span><span class="fu">beta.multidim.plot</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_beta_fd_multidim =</span> beta_fd_indices_fish,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_asb_nm             =</span> <span class="fu">c</span>(<span class="st">"Lower mesopelagic"</span>, <span class="st">"Bathypelagic"</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_family             =</span> <span class="fu">c</span>(<span class="st">"Jaccard"</span>),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_sp_nm              =</span> <span class="fu">c</span>(<span class="st">"Anoplogaster_cornuta"</span>, <span class="st">"Holtbyrnia_anomala"</span>, <span class="st">"Photostylus_pycnopterus"</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">faxes                   =</span> <span class="fu">paste0</span>(<span class="st">"PC"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">name_file               =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">faxes_nm                =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">range_faxes             =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">check_input             =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>beta_plot_fish<span class="sc">$</span><span class="st">"patchwork"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_beta_FD_lw_b-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
</section>
<section id="functional-rarity" class="level1">
<h1>4. Functional rarity</h1>
<section id="different-indices-of-functional-rarity" class="level2">
<h2 class="anchored" data-anchor-id="different-indices-of-functional-rarity">4.1 Different indices of functional rarity</h2>
<p><span style="color:#2596be;"><strong>Functional originality indices</strong></span>:</p>
<ul>
<li><p><strong>Functional distinctiveness</strong> is the mean of dissimilarity of the focal species to all the other species of the set of interest. It can be abundance-weighted if needed.</p></li>
<li><p><strong>Functional uniqueness</strong> is the smallest dissimilarity that exists between the focal species and the all other species in the set. It does not consider the abundance of any species.</p></li>
</ul>
<p><span style="color:#2596be;"><strong>Rarity indices</strong></span>:</p>
<ul>
<li><p><strong>Scarcity</strong> is proportional to the relative abundance of the species. It gets close to one when the species is (relatively) rare and close to 0 when its dominant</p></li>
<li><p><strong>Restrictedness</strong> is 1 minus the ratio of sites a species occupy over the total number of sites.</p></li>
</ul>
</section>
<section id="computing-functional-rarity" class="level2">
<h2 class="anchored" data-anchor-id="computing-functional-rarity">4.2.Computing functional rarity</h2>
<section id="functional-originality-at-regional-scale" class="level3">
<h3 class="anchored" data-anchor-id="functional-originality-at-regional-scale">4.2.1 Functional originality at regional scale</h3>
<ul>
<li>For the choice or dissimilarity matrix we can use the raw dissimilarity matrix computed directly on raw traits values among species:</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sp_di <span class="ot">&lt;-</span> funrar<span class="sc">::</span><span class="fu">distinctiveness_global</span>(sp_dist_fish, <span class="at">di_name =</span> <span class="st">"distinctiveness"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">tagList</span>(DT<span class="sc">::</span><span class="fu">datatable</span>(sp_di))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f571907a19eeef4c6313" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f571907a19eeef4c6313">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41"],["Anoplogaster_cornuta","Arctozenus_risso","Argyropelecus_hemigymnus","Argyropelecus_olfersii","Bathylagus_euryops","Benthosema_glaciale","Bolinichthys_supralateralis","Borostomias_antarcticus","Ceratoscopelus_maderensis","Chauliodus_sloani","Cyclothone_sp","Derichthys_serpentinus","Diaphus_metoclampus","Evermannella_balbo","Gonostoma_elongatum","Holtbyrnia_anomala","Holtbyrnia_macrops","Lampanyctus_ater","Lampanyctus_crocodilus","Lampanyctus_macdonaldi","Lestidiops_sphyrenoides","Lobianchia_gemellarii","Malacosteus_niger","Maulisia_argipalla","Maulisia_mauli","Maulisia_microlepis","Maurolicus_muelleri","Melanostigma_atlanticum","Melanostomias_bartonbeani","Myctophum_punctatum","Normichthys_operosus","Notoscopelus_bolini","Notoscopelus_kroyeri","Paralepis_coregonoides ","Photostylus_pycnopterus","Sagamichthys_schnakenbecki","Searsia_koefoedi","Serrivomer_beanii","Sigmops_bathyphilus","Stomias_boa","Xenodermichthys_copei"],[0.3474235353638858,0.2128276334028571,0.2904536539272046,0.281954274600248,0.2112061681400249,0.2059299479907813,0.2205297119552489,0.2577768477533011,0.1777316495178109,0.3723049947093757,0.2652278878309365,0.3063502371549318,0.2207148838457942,0.3384078595429094,0.2589582420556513,0.2288919354769615,0.1958822069078748,0.1821230118425658,0.1879982872912118,0.2235021270463685,0.2505910986598637,0.1985837149946914,0.3526657787248053,0.1882707105862882,0.1840244217418455,0.2313766860693964,0.2149543116317324,0.2769516524079481,0.3635239957135539,0.1885879713453348,0.1843343836386956,0.1834697008233927,0.1806486740725788,0.2883896716641033,0.2420676130650323,0.1970618319096552,0.1737487211100869,0.3496492039658237,0.2177715131682252,0.3482488978131095,0.2528305395603939]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>species<\/th>\n      <th>distinctiveness<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li>Another option would be to compute a new functional dissimilarity matrix based on the selected functional axes. One advantage of the latter is that it already takes into account the correlation between traits (recompute regional functional distinctiveness based on the n selected functional axes. Because the space comes from a PCA, we can directly use euclidean distance):</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>new_dissim <span class="ot">&lt;-</span> <span class="fu">dist</span>(sp_faxes_coord_fish[, <span class="fu">c</span>(<span class="st">"PC1"</span>, <span class="st">"PC2"</span>, <span class="st">"PC3"</span>, <span class="st">"PC4"</span>)])</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>sp_di_alt <span class="ot">&lt;-</span> funrar<span class="sc">::</span><span class="fu">distinctiveness_global</span>(new_dissim, <span class="at">di_name =</span> <span class="st">"alt_di"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#We can now compare both distinctiveness values.</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>sp_all_di <span class="ot">&lt;-</span> <span class="fu">merge</span>(sp_di, sp_di_alt, <span class="at">by =</span> <span class="st">"species"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sp_all_di<span class="sc">$</span>distinctiveness, sp_all_di<span class="sc">$</span>alt_di)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/distinctiveness_n_axis-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(sp_all_di<span class="sc">$</span>distinctiveness, sp_all_di<span class="sc">$</span>alt_di)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  sp_all_di$distinctiveness and sp_all_di$alt_di
t = 23.765, df = 39, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9388754 0.9824797
sample estimates:
      cor 
0.9671647 </code></pre>
</div>
</div>
<p>Both seems very correlated, so in our case using either one should be fine. However, it can be better to use dissimilarity based on a reduced number of well-defined axes because: (1) there are more interpretable thanks to the multivariate analysis, (2) the first one contain of the most information, (3) they explicitly take into account potentially strong correlations between provided traits. We’ll stick here with raw dissimilarity for the sake of simplicity</p>
<p>To compute uniqueness at regional scale we also need the regional level functional dissimilarity matrix with the uniqueness() function, and the site-species matrix:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sp_ui <span class="ot">&lt;-</span> funrar<span class="sc">::</span><span class="fu">uniqueness</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pres_matrix =</span> depth_fish_biomass,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(sp_dist_fish)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(sp_ui<span class="sc">$</span>Ui, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        0%        10%        20%        30%        40%        50%        60% 
0.03035540 0.04049332 0.05202209 0.06331655 0.07752888 0.08742419 0.11940348 
       70%        80%        90%       100% 
0.13493191 0.15855312 0.20818342 0.22497248 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">tagList</span>(DT<span class="sc">::</span><span class="fu">datatable</span>(sp_ui))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d043e4b12bff5d0f7aac" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d043e4b12bff5d0f7aac">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38"],["Anoplogaster_cornuta","Arctozenus_risso","Argyropelecus_hemigymnus","Argyropelecus_olfersii","Bathylagus_euryops","Benthosema_glaciale","Bolinichthys_supralateralis","Borostomias_antarcticus","Ceratoscopelus_maderensis","Chauliodus_sloani","Cyclothone_sp","Derichthys_serpentinus","Evermannella_balbo","Gonostoma_elongatum","Holtbyrnia_anomala","Holtbyrnia_macrops","Lampanyctus_crocodilus","Lampanyctus_macdonaldi","Lestidiops_sphyrenoides","Lobianchia_gemellarii","Malacosteus_niger","Maulisia_argipalla","Maulisia_mauli","Maulisia_microlepis","Maurolicus_muelleri","Melanostigma_atlanticum","Melanostomias_bartonbeani","Myctophum_punctatum","Lampanyctus_ater","Normichthys_operosus","Notoscopelus_kroyeri","Photostylus_pycnopterus","Sagamichthys_schnakenbecki","Searsia_koefoedi","Serrivomer_beanii","Sigmops_bathyphilus","Xenodermichthys_copei","Notoscopelus_bolini"],[0.2249724789440367,0.07780048982062067,0.1350846448701017,0.1528126418836971,0.1176825226682185,0.07869585498402229,0.1129921829454625,0.1262873252148768,0.04049332163604825,0.2081834209388946,0.1335572841772924,0.1770975056328812,0.2140763266869283,0.1117001739383256,0.07644244905429304,0.0552024912524502,0.04563773832466766,0.06578292242973674,0.07780048982062067,0.06578292242973674,0.2167307310652254,0.03035540037384281,0.03035540037384281,0.1274434182392546,0.09120983712936397,0.1469688850096205,0.2081834209388946,0.04049332163604825,0.06304250442540542,0.03626914731113035,0.04066738670835385,0.1585531237947687,0.0552024912524502,0.04990182369327653,0.1827444371373168,0.08363853683493312,0.1585531237947687,0.05724982792289757]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>species<\/th>\n      <th>Ui<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Based on these results we see that <em>Anoplogaster cornuta</em>, <em>Evermannella balbo</em>, and <em>Chauliodus sloani</em> are the most isolated fish in the functional space. Meaning that they have the most distant nearest neighbors.</p>
</section>
<section id="functional-originality-at-local-scale" class="level3">
<h3 class="anchored" data-anchor-id="functional-originality-at-local-scale">4.2.2 Functional originality at local scale</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>sp_local_di <span class="ot">&lt;-</span> funrar<span class="sc">::</span><span class="fu">distinctiveness</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  depth_fish_biomass, <span class="fu">as.matrix</span>(sp_dist_fish)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>sp_local_di[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  Anoplogaster_cornuta Arctozenus_risso
Upper mesopelagic                   NA        0.1741345
Bathypelagic                 0.3265944        0.2531392
Epipelagic                          NA        0.1565857
Lower mesopelagic                   NA        0.1700968
                  Argyropelecus_hemigymnus Argyropelecus_olfersii
Upper mesopelagic                0.2712219              0.2651073
Bathypelagic                     0.2959860              0.3325026
Epipelagic                              NA              0.2349658
Lower mesopelagic                0.2722708              0.2648721
                  Bathylagus_euryops Benthosema_glaciale
Upper mesopelagic                 NA           0.1740355
Bathypelagic                0.245879           0.2348102
Epipelagic                        NA           0.1182136
Lower mesopelagic                 NA           0.1650842
                  Bolinichthys_supralateralis Borostomias_antarcticus
Upper mesopelagic                          NA               0.2649623
Bathypelagic                        0.2186404               0.2217742
Epipelagic                                 NA                      NA
Lower mesopelagic                   0.1893132               0.2545473
                  Ceratoscopelus_maderensis Chauliodus_sloani
Upper mesopelagic                 0.1593837         0.3937305
Bathypelagic                      0.2092825         0.3079344
Epipelagic                        0.0942359                NA
Lower mesopelagic                 0.1441832         0.3920527</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">dim</span>(sp_local_di), <span class="fu">dim</span>(depth_fish_biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>To compute uniqueness at the site scale, we must use a more complex expression as it was not envisioned for local computation:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>depth_ui <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  depth_fish_biomass, <span class="dv">1</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(single_site, dist_m) {</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    single_site <span class="ot">=</span> single_site[single_site <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(single_site)]</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    funrar<span class="sc">::</span><span class="fu">uniqueness</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(single_site)), dist_m)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">dist_m =</span> <span class="fu">as.matrix</span>(sp_dist_fish)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(depth_ui[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`Upper mesopelagic`
                      species         Ui
1            Arctozenus_risso 0.07780049
2    Argyropelecus_hemigymnus 0.13508464
3      Argyropelecus_olfersii 0.16568529
4         Benthosema_glaciale 0.08137893
5     Borostomias_antarcticus 0.13458900
6   Ceratoscopelus_maderensis 0.04049332
7           Chauliodus_sloani 0.20818342
8               Cyclothone_sp 0.17904425
9      Derichthys_serpentinus 0.17709751
10         Evermannella_balbo 0.21407633
11         Holtbyrnia_macrops 0.05520249
12     Lampanyctus_crocodilus 0.04563774
13    Lestidiops_sphyrenoides 0.07780049
14      Lobianchia_gemellarii 0.07992847
15          Malacosteus_niger 0.21673073
16             Maulisia_mauli 0.06694465
17        Maurolicus_muelleri 0.09120984
18    Melanostigma_atlanticum 0.14696889
19  Melanostomias_bartonbeani 0.20818342
20        Myctophum_punctatum 0.04049332
21           Lampanyctus_ater 0.06304250
22       Notoscopelus_kroyeri 0.04066739
23 Sagamichthys_schnakenbecki 0.05520249
24           Searsia_koefoedi 0.04990182
25          Serrivomer_beanii 0.18274444
26      Xenodermichthys_copei 0.15913755</code></pre>
</div>
</div>
<p>As we had to manually build the function to compute the local uniqueness the results are strangely formatted.</p>
<p>We provide here a function that can help them to be more easily read:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>depth_ui <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(depth_ui), <span class="cf">function</span>(x) {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  single_depth <span class="ot">=</span> depth_ui[[x]]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  single_depth<span class="sc">$</span>site <span class="ot">=</span> x</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(single_depth)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>depth_ui <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, depth_ui)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Then we can again look at the apple to see how its uniqueness varies across depths.</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(depth_ui, species <span class="sc">==</span> <span class="st">"Melanostomias_bartonbeani"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      species        Ui              site
19  Melanostomias_bartonbeani 0.2081834 Upper mesopelagic
53  Melanostomias_bartonbeani 0.2081834      Bathypelagic
75  Melanostomias_bartonbeani 0.2966495        Epipelagic
103 Melanostomias_bartonbeani 0.2081834 Lower mesopelagic</code></pre>
</div>
</div>
<p>4.3.3.Rarity indices</p>
<p><strong>scarcity</strong>:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>rel_weights <span class="ot">=</span> funrar<span class="sc">::</span><span class="fu">make_relative</span>(depth_fish_biomass)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>si <span class="ot">=</span>  funrar<span class="sc">::</span><span class="fu">scarcity</span>(rel_weights)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(si)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Anoplogaster_cornuta Arctozenus_risso Argyropelecus_hemigymnus
 Min.   :0.9894       Min.   :0.2241   Min.   :0.9552          
 1st Qu.:0.9894       1st Qu.:0.2246   1st Qu.:0.9748          
 Median :0.9894       Median :0.4195   Median :0.9945          
 Mean   :0.9894       Mean   :0.4810   Mean   :0.9829          
 3rd Qu.:0.9894       3rd Qu.:0.6759   3rd Qu.:0.9967          
 Max.   :0.9894       Max.   :0.8610   Max.   :0.9989          
 NA's   :3                             NA's   :1               
 Argyropelecus_olfersii Bathylagus_euryops Benthosema_glaciale
 Min.   :0.1391         Min.   :0.7501     Min.   :0.1861     
 1st Qu.:0.4735         1st Qu.:0.7501     1st Qu.:0.5025     
 Median :0.7039         Median :0.7501     Median :0.6259     
 Mean   :0.6082         Mean   :0.7501     Mean   :0.5855     
 3rd Qu.:0.8387         3rd Qu.:0.7501     3rd Qu.:0.7088     
 Max.   :0.8861         Max.   :0.7501     Max.   :0.9040     
                        NA's   :3                             
 Bolinichthys_supralateralis Borostomias_antarcticus Ceratoscopelus_maderensis
 Min.   :0.9153              Min.   :0.9413          Min.   :0.2886           
 1st Qu.:0.9349              1st Qu.:0.9597          1st Qu.:0.3544           
 Median :0.9545              Median :0.9781          Median :0.5431           
 Mean   :0.9545              Mean   :0.9701          Mean   :0.5775           
 3rd Qu.:0.9741              3rd Qu.:0.9845          3rd Qu.:0.7662           
 Max.   :0.9937              Max.   :0.9909          Max.   :0.9353           
 NA's   :2                   NA's   :1                                        
 Chauliodus_sloani Cyclothone_sp    Derichthys_serpentinus Evermannella_balbo
 Min.   :0.8757    Min.   :0.0000   Min.   :0.9515         Min.   :0.8150    
 1st Qu.:0.8890    1st Qu.:0.3383   1st Qu.:0.9689         1st Qu.:0.9029    
 Median :0.9022    Median :0.7009   Median :0.9863         Median :0.9909    
 Mean   :0.9199    Mean   :0.5886   Mean   :0.9775         Mean   :0.9335    
 3rd Qu.:0.9420    3rd Qu.:0.9512   3rd Qu.:0.9905         3rd Qu.:0.9928    
 Max.   :0.9818    Max.   :0.9524   Max.   :0.9947         Max.   :0.9947    
 NA's   :1                          NA's   :1              NA's   :1         
 Gonostoma_elongatum Holtbyrnia_anomala Holtbyrnia_macrops
 Min.   :0.8566      Min.   :0.978      Min.   :0.9728    
 1st Qu.:0.8888      1st Qu.:0.978      1st Qu.:0.9782    
 Median :0.9209      Median :0.978      Median :0.9836    
 Mean   :0.9209      Mean   :0.978      Mean   :0.9844    
 3rd Qu.:0.9531      3rd Qu.:0.978      3rd Qu.:0.9902    
 Max.   :0.9853      Max.   :0.978      Max.   :0.9968    
 NA's   :2           NA's   :3          NA's   :1         
 Lampanyctus_crocodilus Lampanyctus_macdonaldi Lestidiops_sphyrenoides
 Min.   :0.003498       Min.   :0.7893         Min.   :0.8640         
 1st Qu.:0.034610       1st Qu.:0.7893         1st Qu.:0.9217         
 Median :0.151031       Median :0.7893         Median :0.9682         
 Mean   :0.155920       Mean   :0.7893         Mean   :0.9493         
 3rd Qu.:0.272341       3rd Qu.:0.7893         3rd Qu.:0.9958         
 Max.   :0.318123       Max.   :0.7893         Max.   :0.9968         
                        NA's   :3                                     
 Lobianchia_gemellarii Malacosteus_niger Maulisia_argipalla Maulisia_mauli  
 Min.   :0.9295        Min.   :0.9483    Min.   :0.9307     Min.   :0.8638  
 1st Qu.:0.9357        1st Qu.:0.9522    1st Qu.:0.9422     1st Qu.:0.9183  
 Median :0.9436        Median :0.9561    Median :0.9538     Median :0.9727  
 Mean   :0.9420        Mean   :0.9561    Mean   :0.9538     Mean   :0.9440  
 3rd Qu.:0.9499        3rd Qu.:0.9601    3rd Qu.:0.9654     3rd Qu.:0.9841  
 Max.   :0.9515        Max.   :0.9640    Max.   :0.9769     Max.   :0.9954  
                       NA's   :2         NA's   :2          NA's   :1       
 Maulisia_microlepis Maurolicus_muelleri Melanostigma_atlanticum
 Min.   :0.9003      Min.   :0.2555      Min.   :0.9358         
 1st Qu.:0.9003      1st Qu.:0.2629      1st Qu.:0.9651         
 Median :0.9003      Median :0.5930      Median :0.9754         
 Mean   :0.9003      Mean   :0.5975      Mean   :0.9682         
 3rd Qu.:0.9003      3rd Qu.:0.9276      3rd Qu.:0.9785         
 Max.   :0.9003      Max.   :0.9483      Max.   :0.9863         
 NA's   :3                                                      
 Melanostomias_bartonbeani Myctophum_punctatum Lampanyctus_ater
 Min.   :0.8794            Min.   :0.05241     Min.   :0.7337  
 1st Qu.:0.9064            1st Qu.:0.38476     1st Qu.:0.8103  
 Median :0.9435            Median :0.55380     Median :0.9021  
 Mean   :0.9356            Mean   :0.50618     Mean   :0.8785  
 3rd Qu.:0.9728            3rd Qu.:0.67522     3rd Qu.:0.9703  
 Max.   :0.9759            Max.   :0.86469     Max.   :0.9759  
                                                               
 Normichthys_operosus Notoscopelus_kroyeri Photostylus_pycnopterus
 Min.   :0.5662       Min.   :0.1046       Min.   :0.9937         
 1st Qu.:0.5662       1st Qu.:0.2676       1st Qu.:0.9937         
 Median :0.5662       Median :0.4199       Median :0.9937         
 Mean   :0.5662       Mean   :0.4157       Mean   :0.9937         
 3rd Qu.:0.5662       3rd Qu.:0.5680       3rd Qu.:0.9937         
 Max.   :0.5662       Max.   :0.7181       Max.   :0.9937         
 NA's   :3                                 NA's   :3              
 Sagamichthys_schnakenbecki Searsia_koefoedi Serrivomer_beanii
 Min.   :0.9255             Min.   :0.5295   Min.   :0.3697   
 1st Qu.:0.9537             1st Qu.:0.6528   1st Qu.:0.5046   
 Median :0.9818             Median :0.7806   Median :0.5673   
 Mean   :0.9677             Mean   :0.7516   Mean   :0.5415   
 3rd Qu.:0.9888             3rd Qu.:0.8795   3rd Qu.:0.6042   
 Max.   :0.9958             Max.   :0.9157   Max.   :0.6617   
 NA's   :1                                                    
 Sigmops_bathyphilus Xenodermichthys_copei Notoscopelus_bolini
 Min.   :0.9749      Min.   :0.001488      Min.   :0.3507     
 1st Qu.:0.9749      1st Qu.:0.008431      1st Qu.:0.6617     
 Median :0.9749      Median :0.320069      Median :0.9727     
 Mean   :0.9749      Mean   :0.337104      Mean   :0.7717     
 3rd Qu.:0.9749      3rd Qu.:0.648742      3rd Qu.:0.9821     
 Max.   :0.9749      Max.   :0.706791      Max.   :0.9915     
 NA's   :3                                 NA's   :1          </code></pre>
</div>
</div>
<p>__ restrictiveness__:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ri <span class="ot">=</span> funrar<span class="sc">::</span><span class="fu">restrictedness</span>(depth_fish_biomass)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   species                Ri        
 Length:38          Min.   :0.0000  
 Class :character   1st Qu.:0.0000  
 Mode  :character   Median :0.2500  
                    Mean   :0.2697  
                    3rd Qu.:0.5000  
                    Max.   :0.7500  </code></pre>
</div>
</div>
</section>
</section>
<section id="plotting-functional-rarity" class="level2">
<h2 class="anchored" data-anchor-id="plotting-functional-rarity">4.3 Plotting functional rarity</h2>
<section id="plotting-functional-originality" class="level3">
<h3 class="anchored" data-anchor-id="plotting-functional-originality">4.3.1 Plotting functional originality</h3>
<p>option to be able to colour species according to their functional originality (and not use the ready-made functions in the mfd package)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a summary data.frame</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>sp_coord_di_ui <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sp_faxes_coord_fish[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>sp_coord_di_ui<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">rownames</span>(sp_coord_di_ui)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sp_coord_di_ui) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>sp_coord_di_ui <span class="ot">&lt;-</span> sp_coord_di_ui[, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>sp_coord_di_ui <span class="ot">&lt;-</span> <span class="fu">merge</span>(sp_coord_di_ui, sp_di, <span class="at">by =</span> <span class="st">"species"</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>sp_coord_di_ui <span class="ot">&lt;-</span> <span class="fu">merge</span>(sp_coord_di_ui, sp_ui, <span class="at">by =</span> <span class="st">"species"</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>plot_reg_distinctiveness <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sp_coord_di_ui, <span class="fu">aes</span>(PC1, PC2)) <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> distinctiveness), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> species), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">high =</span> <span class="st">"#914568"</span>, <span class="at">low =</span> <span class="st">"#6BA1B9"</span>, <span class="st">"Functional</span><span class="sc">\n</span><span class="st">Distinctiveness"</span>)<span class="sc">+</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>plot_reg_uniqueness <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sp_coord_di_ui, <span class="fu">aes</span>(PC1, PC2)) <span class="sc">+</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Ui), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> species), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">high =</span> <span class="st">"#914568"</span>, <span class="at">low =</span> <span class="st">"#6BA1B9"</span>,<span class="st">"Functional</span><span class="sc">\n</span><span class="st">Uniqueness"</span>) <span class="sc">+</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(plot_reg_distinctiveness, plot_reg_uniqueness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_si_ri-1.png" class="img-fluid" width="1248"></p>
</div>
</div>
<ul>
<li><p>As was done with mFD to correlate the functional axes with species’ traits we can correlate functional distinctiveness to specific traits in order to see which traits are mainly driving distinctiveness.</p></li>
<li><p>Regarding local level functional originality indices, the visualization can be more difficult to grasp and depends highly on the question. Would you rather focus on visualizing the functional distinctiveness of one species across communities? Compare the distribution of functional distinctiveness values across communities?</p></li>
<li><p>One idea to keep in mind is that averaging functional distinctiveness per community is exactly equal to computing functional dispersion. Functional originality is computed on a species basis, so we should be aware that if we are rather interested by community properties than we can compute functional diversity metrics which are much more appropriate.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>local_di_ap <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sp_local_di[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span> <span class="dv">11</span>)])</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>local_di_ap<span class="sc">$</span>depth <span class="ot">&lt;-</span> <span class="fu">rownames</span>(local_di_ap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plotting-rarity" class="level3">
<h3 class="anchored" data-anchor-id="plotting-rarity">4.3.2. Plotting rarity</h3>
<ul>
<li><strong>Functional Distinctiveness</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sp_di_ri <span class="ot">&lt;-</span> <span class="fu">merge</span>(sp_di, ri, <span class="at">by =</span> <span class="st">"species"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>sp_di_ri_ui <span class="ot">&lt;-</span> <span class="fu">merge</span>(sp_di_ri, sp_ui, <span class="at">by =</span> <span class="st">"species"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>plot_dist_ri_reg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sp_di_ri, <span class="fu">aes</span>(distinctiveness, Ri)) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> species)) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Functional Distinctiveness"</span>, <span class="at">y =</span> <span class="st">"Geographical Restrictedness"</span>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>plot_dist_ri_reg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_dist_ri_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On this visualization we can clearly see that <em>Anoplogaster cornuta</em> is overall the most distinct species while being quite restricted in terms of depth. On the other hand, the two Myctophidae <em>Lampanyctus ater</em> and <em>Lobianchia_gemellarii</em> are the most functionally common and regionally widespread species (low restrictedness).</p>
<ul>
<li><strong>Functional Uniqueness</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>plot_ui_ri_reg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sp_di_ri_ui, <span class="fu">aes</span>(Ui, Ri)) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> species)) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Functional Uniqueness"</span>, <span class="at">y =</span> <span class="st">"Geographical Restrictedness"</span>) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>plot_ui_ri_reg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_ui_ri_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>plot local scale measurements:</li>
</ul>
<p><strong>bathypelagic layer</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>sp_local_di_df <span class="ot">&lt;-</span> funrar<span class="sc">::</span><span class="fu">matrix_to_stack</span>(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  sp_local_di, <span class="at">value_col =</span> <span class="st">"local_di"</span>, <span class="at">row_to_col =</span> <span class="st">"depth"</span>,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_to_col =</span> <span class="st">"species"</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>sp_local_si_df <span class="ot">&lt;-</span> funrar<span class="sc">::</span><span class="fu">matrix_to_stack</span>(</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  si, <span class="at">value_col =</span> <span class="st">"local_si"</span>, <span class="at">row_to_col =</span> <span class="st">"depth"</span>, <span class="at">col_to_col =</span> <span class="st">"species"</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>sp_local_di_si <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  sp_local_di_df, sp_local_si_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"depth"</span>, <span class="st">"species"</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sp_local_di_si)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         depth                  species  local_di  local_si
1 Bathypelagic     Anoplogaster_cornuta 0.3265944 0.9894439
2 Bathypelagic         Arctozenus_risso 0.2531392 0.8610242
3 Bathypelagic Argyropelecus_hemigymnus 0.2959860 0.9989393
4 Bathypelagic   Argyropelecus_olfersii 0.3325026 0.8860520
5 Bathypelagic       Bathylagus_euryops 0.2458790 0.7500677
6 Bathypelagic      Benthosema_glaciale 0.2348102 0.6437736</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>plot_local_di_si <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sp_local_di_si, <span class="fu">aes</span>(local_di, local_si)) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Functional Distinctiveness"</span>, <span class="at">y =</span> <span class="st">"Scarcity"</span>) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>plot_local_di_si</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot_local_di_si-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>